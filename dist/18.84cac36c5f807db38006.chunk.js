webpackJsonp([18],{1140:function(t,e,i){var n=i(1141);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(20)("70a6e454",n,!1)},1141:function(t,e,i){e=t.exports=i(19)(void 0),e.push([t.i,"\n.expand-row[data-v-abfa3288] {\n    margin-bottom: 16px;\n    margin-top: 16px;\n}\n.soltTitle[data-v-abfa3288] {\n    line-height: 1;\n    border-bottom: 1px solid #e3e8ee;\n    padding: 17px 16px;\n    margin-left: -16px;\n    margin-right: -19px;\n    font-weight: 900;\n    color: #464c5b;\n}\n",""])},1142:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Row",[i("Col",{attrs:{span:"24"}},[i("Card",[i("Row",[i("Col",{attrs:{span:"12"}},[i("AutoComplete",{staticStyle:{width:"300px",float:"left"},attrs:{icon:"ios-search",placeholder:"申请单号/订单编号/订单名称/申请金额"},on:{"on-search":t.searchInvoice},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Button",{directives:[{name:"show",rawName:"v-show",value:t.showBtn,expression:"showBtn"}],staticClass:"fr",attrs:{type:"primary"},on:{click:function(e){t.addApplication()}}},[i("Icon",{attrs:{type:"plus",color:"#fff"}}),t._v("  新建")],1)],1)],1),t._v(" "),i("div",{staticClass:"clearfix margin-top-10"},[i("Table",{staticStyle:{width:"100%",float:"left"},attrs:{size:"small",stripe:"",columns:t.invoiceColumns,data:t.invoiceData,loading:t.loadingMorn}}),t._v(" "),i("Page",{staticClass:"margin-top-10 fr",attrs:{total:t.totalPage,size:"small","show-elevator":"","show-sizer":""},on:{"on-change":t.changeSize,"on-page-size-change":t.changePagesize}})],1)],1)],1)],1),t._v(" "),0==t.haveSalesBill?i("Modal",{staticStyle:{"text-align":"center"},attrs:{title:"增值税专用发票",width:"50%"},on:{"on-cancel":t.cancel},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("Form",{attrs:{"label-position":"top"}},[i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[t._v("采购商名称:")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t.purchaserName))])],1),t._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[t._v("销售方名称: ")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t.supplierName))])],1)],1),t._v(" "),i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[t._v("发票金额(含税):")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t._f("money")(t.taxIncludedSum)))])],1),t._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[t._v("税额: ")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t._f("money")(t.taxSum)))])],1)],1),t._v(" "),i("Row",[i("Col",{attrs:{span:"24"}},[i("Table",{ref:"selection",attrs:{size:"small",height:"200",border:"",columns:t.columnsInvoice,data:t.invoiceList}})],1)],1)],1),t._v(" "),i("div",{staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[i("Page",{staticClass:"fr",staticStyle:{"margin-top":"4px"},attrs:{total:t.totalPages,"page-size":1,size:"small"},on:{"on-change":t.changeSizes,"on-page-size-change":t.changePagesizes}})],1)],1):t._e(),t._v(" "),1==t.haveSalesBill?i("Modal",{staticStyle:{"text-align":"center"},attrs:{title:"增值税专用发票",width:"50%"},on:{"on-cancel":t.cancel},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("Form",{attrs:{"label-position":"top"}},[i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[t._v("采购商名称:")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t.purchaserName))])],1),t._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[t._v("销售方名称: ")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t.supplierName))])],1)],1),t._v(" "),i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[t._v("发票金额(含税):")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t._f("money")(t.taxIncludedSum)))])],1),t._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[t._v("税额: ")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t._f("money")(t.taxSum)))])],1)],1),t._v(" "),i("Row",[i("Col",{attrs:{span:"24"}},[i("Table",{ref:"selection",attrs:{size:"small",columns:t.ncolumnsInvoice,data:t.ninvoiceList}})],1)],1)],1),t._v(" "),i("Form",{attrs:{"label-position":"top"}},[i("Row",[i("Col",{attrs:{span:"24"}},[i("p",{staticClass:"soltTitle margin-bottom-10"},[t._v("销售货物或者提供应税劳务清单")])])],1),t._v(" "),i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[t._v("采购商名称:")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t.purchaserName))])],1),t._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[t._v("销售方名称: ")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t.supplierName))])],1)],1),t._v(" "),i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[t._v("发票金额(含税):")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t._f("money")(t.taxIncludedSum)))])],1),t._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[t._v("税额: ")]),t._v(" "),i("Col",{attrs:{span:"11"}},[t._v(t._s(t._f("money")(t.taxSum)))])],1)],1),t._v(" "),i("Row",[i("Col",{attrs:{span:"24"}},[i("Table",{ref:"selection",attrs:{size:"small",columns:t.columnsInvoice,data:t.invoiceList}})],1)],1)],1),t._v(" "),i("div",{staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[i("Page",{staticClass:"fr",attrs:{total:t.totalPages,"page-size":1,size:"small"},on:{"on-change":t.changeSizes,"on-page-size-change":t.changePagesizes}})],1)],1):t._e()],1)},o=[];n._withStripped=!0;var a={render:n,staticRenderFns:o};e.default=a},315:function(t,e,i){"use strict";function n(t){r||i(1140)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(602),a=i.n(o);for(var s in o)"default"!==s&&function(t){i.d(e,t,function(){return o[t]})}(s);var c=i(1142),l=i.n(c),r=!1,p=i(4),v=n,u=p(a.a,l.a,!1,v,"data-v-abfa3288",null);u.options.__file="src/views/clearingTicket/application.vue",e.default=u.exports},349:function(t,e,i){"use strict";e.__esModule=!0;var n=i(350),o=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=function(t,e,i){return e in t?(0,o.default)(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},350:function(t,e,i){t.exports={default:i(351),__esModule:!0}},351:function(t,e,i){i(352);var n=i(0).Object;t.exports=function(t,e,i){return n.defineProperty(t,e,i)}},352:function(t,e,i){var n=i(9);n(n.S+n.F*!i(11),"Object",{defineProperty:i(10).f})},602:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(349),a=n(o),s=i(6),c=n(s),l=i(15),r=n(l);e.default={name:"",data:function(){var t,e=this;return t={totalPage:1,pageIndex:1,pageSize:10,totalPages:1,pageIndexs:1,pageSizes:1,userType:"",showBtn:!1,modal:!1,modal_loading:!1,loadingMorn:!1,searchValue:"",haveSalesBill:"",invoiceApplyItemList:[],purchaserName:"",supplierName:"",taxIncludedSum:"",taxSum:"",invoiceColumns:[{type:"index",title:"序号",width:60},{title:"开票申请单单号",key:"noticeNo",align:"center",sortable:!0,render:function(t,i){return t("span",[t("a",{style:{},on:{click:function(){e.lookDetail(i.row.invoiceApplicationId)}}},i.row.noticeNo)])}},{title:"订单编号",key:"contractCode"},{title:"订单名称",key:"contractName"},{title:"购货单位",sortable:!0,render:function(t,i){return 0==e.userType?t("span",i.row.purchaserName):t("span",i.row.supplierName)},renderHeader:function(t,i){return 0==e.userType?t("span",{domProps:{innerHTML:"购货单位"}}):t("span",{domProps:{innerHTML:"销货单位"}})}},{title:"申请开票金额",key:"invoiceApplyMoney",render:function(t,e){return t("span",r.default.formatNum(e.row.invoiceApplyMoney,2))},sortable:!0},{title:"开票方式",key:"applyMethod"},{title:"状态",key:"state",sortable:!0,width:100,render:function(t,e){return 0==e.row.state?t("span","待提交"):1==e.row.state?t("span","待确认"):2==e.row.state?t("span","已驳回"):3==e.row.state?t("span","待开票"):4==e.row.state?t("span","登记中"):5==e.row.state?t("span","已登记"):6==e.row.state?t("span","已开票"):7==e.row.state?t("span","已退票"):void 0}},{title:"操作",key:"operation",render:function(t,i){if("0"===e.userType){if(0==i.row.state||2==i.row.state)return t("div",[t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.UpdateList(i.row.invoiceApplicationId,i.row.contractId,i.row.noticeNo)}}},"提交"),t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.editDetial(i.row.invoiceApplicationId)}}},"编辑"),t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.deleteList(i.row.invoiceApplicationId)}}},"删除")]);if(3==i.row.state)return t("div",[t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.invoiceDetail(i.row.invoiceApplicationId)}}},"登记")]);if(4==i.row.state||7==i.row.state)return t("div",[t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.submitInvoice(i.row.invoiceApplicationId,i.row.contractId,i.row.noticeNo)}}},"提交"),t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.getInvoiceDetail(i.row.invoiceApplicationId)}}},"维护")])}else if("1"===e.userType){if(1==i.row.state)return t("div",[t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.comfirmList(i.row.invoiceApplicationId,i.row.noticeNo,i.row.contractId)}}},"确认"),t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.rejectDetial(i.row.invoiceApplicationId,i.row.noticeNo,i.row.contractId)}}},"驳回")]);if(5==i.row.state)return t("div",[t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.comfirmInvoice(i.row.invoiceApplicationId)}}},"确认"),t("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){e.outInvoice(i.row.invoiceApplicationId)}}},"退回")]);i.row.state}}}],invoiceData:[],noticeNo:"",contractCode:"",contractName:"",invoiceApplyMoney:"",columnsInvoice:[{title:"序号",type:"index",width:80,align:"center"},{title:"物资名称",key:"materialName",align:"center",width:200},{title:"规格型号",key:"spectype",align:"center",width:200},{title:"单位",key:"metricunitName",align:"center",width:200},{title:"数量",key:"settlementQuantity",align:"center",width:200},{title:"单价(未税)",key:"price",align:"center",width:200},{title:"金额(未税)",key:"taxExclusiveAmount",align:"center",width:200,render:function(t,e){return t("span",r.default.formatNum(e.row.settlementQuantity*e.row.price,2))}},{title:"税率",key:"itemTax",align:"center",width:200,render:function(t,e){return t("span",100*e.row.itemTax+"%")}},{title:"税额",key:"itemTaxAmount",align:"center",width:200,render:function(t,e){return t("span",r.default.formatNum(e.row.settlementQuantity*e.row.price*e.row.itemTax,2))}}],invoiceList:[],ncolumnsInvoice:[{title:"序号",width:80,align:"center"},{title:"物资名称",key:"materialName",align:"center",width:200},{title:"规格型号",align:"center",width:200},{title:"单位",align:"center",width:200},{title:"数量",align:"center",width:200},{title:"单价(未税)",align:"center",width:200},{title:"金额(未税)",align:"center",width:200},{title:"税率",align:"center",width:200},{title:"税额",align:"center",width:200}],ninvoiceList:[{materialName:"详见销货清单"}]},(0,a.default)(t,"haveSalesBill",""),(0,a.default)(t,"purchaserName",""),(0,a.default)(t,"supplierName",""),(0,a.default)(t,"invoiceApplyMoney",""),(0,a.default)(t,"taxedMoney",""),(0,a.default)(t,"invoiceApplicationId",""),t},mounted:function(){this.invoceList();var t=JSON.parse(c.default.get("userData"));this.userType=t.userType,"0"===this.userType?this.showBtn=!0:this.showBtn=!1},methods:{invoceList:function(){var t=this;this.loadingMorn=!0,this.$httpServer("/invoiceApplication/getInvoiceApplications.do",{pageNum:this.pageIndex,pageSize:this.pageSize,condition:this.noticeNo}).then(function(e){null==e.invoiceApplications?t.invoiceData=[]:t.invoiceData=e.invoiceApplications,t.totalPage=e.pageBean.totalCount,t.loadingMorn=!1})},searchInvoice:function(t){this.noticeNo=t,this.contractCode=t,this.contractName=t,this.invoiceApplyMoney=t,this.invoceList()},changeSize:function(t){this.pageIndex=t,this.invoceList()},changePagesize:function(t){this.pageSize=t,this.invoceList()},addApplication:function(){var t={applicationState:1001};this.$router.push({name:"application_add",query:t})},UpdateList:function(t,e,i){var n=this;this.$httpServer("/invoiceApplication/submitInvoiceApplication.do",{noticeId:t,contractId:e,noticeNo:i,state:1}).then(function(t){n.invoceList(),n.$Message.success("开票申请单已提交")})},comfirmList:function(t,e,i){var n=this;this.$httpServer("/invoiceApplication/comfirmInvoiceApplication.do",{invoiceApplicationId:t,noticeNo:e,contractId:i}).then(function(t){n.invoceList(),n.$Message.success("开票申请单已确认")})},rejectDetial:function(t,e,i){var n=this;this.$httpServer("/invoiceApplication/rejectInvoiceApplication.do",{invoiceApplicationId:t,noticeNo:e,contractId:i}).then(function(t){n.invoceList(),n.$Message.success("开票申请单已驳回")})},deleteList:function(t){var e=this;this.$httpServer("/invoiceApplication/deleteInvoiceApplication.do",{invoiceApplicationId:t}).then(function(t){e.invoceList(),e.$Message.success("开票申请单已删除")})},submitInvoice:function(t,e,i){var n=this;this.$httpServer("/invoiceRegistry/submitRegistry.do",{invoiceApplicationId:t,noticeNo:i,contractId:e}).then(function(t){n.invoceList(),n.$Message.success("发票已提交")})},getInvoiceDetail:function(t){var e={invoiceState:1002,invoiceApplicationId:t};this.$router.push({name:"invoiceAdd",query:e})},comfirmInvoice:function(t){var e=this;this.$httpServer("/invoiceRegistry/comfirmRegistry.do",{invoiceApplicationId:t}).then(function(t){e.invoceList(),e.$Message.success("发票已确认")})},outInvoice:function(t){var e=this;this.$httpServer("/invoiceRegistry/rebackRegistry.do",{invoiceApplicationId:t}).then(function(t){e.invoceList(),e.$Message.success("发票已退票")})},lookDetail:function(t){var e={invoiceApplicationId:t};this.$router.push({name:"application_detail",query:e})},editDetial:function(t){var e={applicationState:1002,invoiceApplicationId:t};this.$router.push({name:"application_add",query:e})},previewDetail:function(t){var e=this;this.modal=!0,this.$httpServer("/invoiceApplication/reviewInvoice.do",{pageNum:this.pageIndexs,pageSize:this.pageSizes,invoiceApplicationId:t}).then(function(t){e.invoiceList=t.invoiceReviewModel.invoiceApplicationItems,e.haveSalesBill=t.invoiceReviewModel.haveSalesBill,e.purchaserName=t.invoiceReviewModel.invoiceNew.purchaserName,e.supplierName=t.invoiceReviewModel.invoiceNew.supplierName,e.taxIncludedSum=t.invoiceReviewModel.invoiceNew.taxIncludedSum,e.taxSum=t.invoiceReviewModel.invoiceNew.taxSum,e.invoiceApplicationId=t.invoiceReviewModel.invoiceNew.invoiceApplictionId,e.totalPages=t.pageBean.totalPages})},fillInvoice:function(t){var e=this;this.$httpServer("/invoiceApplication/fillInvoiceData.do",{invoiceApplicationId:t}).then(function(t){e.invoceList()})},invoiceDetail:function(t){var e={invoiceState:1001,invoiceApplicationId:t};this.$router.push({name:"invoiceAdd",query:e})},changeSizes:function(t){var e=this;this.pageIndexs=t,this.modal=!0,this.$httpServer("/invoiceApplication/reviewInvoice.do",{pageNum:this.pageIndexs,pageSize:this.pageSizes,invoiceApplicationId:this.invoiceApplicationId}).then(function(t){e.invoiceList=t.invoiceReviewModel.invoiceApplicationItems,e.haveSalesBill=t.invoiceReviewModel.haveSalesBill,e.purchaserName=t.invoiceReviewModel.invoiceNew.purchaserName,e.supplierName=t.invoiceReviewModel.invoiceNew.supplierName,e.taxIncludedSum=t.invoiceReviewModel.invoiceNew.taxIncludedSum,e.taxSum=t.invoiceReviewModel.invoiceNew.taxSum,e.totalPages=t.pageBean.totalPages})},changePagesizes:function(t){this.pageSizes=t},cancel:function(){this.modal=!1}}}}});