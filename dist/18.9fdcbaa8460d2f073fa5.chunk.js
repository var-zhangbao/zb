webpackJsonp([18],{1129:function(e,t,i){var n=i(1130);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(18)("70a6e454",n,!1)},1130:function(e,t,i){t=e.exports=i(17)(void 0),t.push([e.i,"\n.expand-row[data-v-abfa3288] {\n    margin-bottom: 16px;\n    margin-top: 16px;\n}\n.soltTitle[data-v-abfa3288] {\n    line-height: 1;\n    border-bottom: 1px solid #e3e8ee;\n    padding: 17px 16px;\n    margin-left: -16px;\n    margin-right: -19px;\n    font-weight: 900;\n    color: #464c5b;\n}\n",""])},1131:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Row",[i("Col",{attrs:{span:"24"}},[i("Card",[i("Row",[i("Col",{attrs:{span:"12"}},[i("AutoComplete",{staticStyle:{width:"300px",float:"left"},attrs:{icon:"ios-search",placeholder:"申请单号/订单编号/订单名称/申请金额"},on:{"on-search":e.searchInvoice},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),i("Col",{attrs:{span:"12"}},[i("Button",{directives:[{name:"show",rawName:"v-show",value:e.showBtn,expression:"showBtn"}],staticClass:"fr",attrs:{type:"primary"},on:{click:function(t){e.addApplication()}}},[i("Icon",{attrs:{type:"plus",color:"#fff"}}),e._v("  新建")],1)],1)],1),e._v(" "),i("div",{staticClass:"clearfix margin-top-10"},[i("Table",{staticStyle:{width:"100%",float:"left"},attrs:{size:"small",stripe:"",columns:e.invoiceColumns,data:e.invoiceData,loading:e.loadingMorn}}),e._v(" "),i("Page",{staticClass:"margin-top-10 fr",attrs:{total:e.totalPage,size:"small","show-elevator":"","show-sizer":""},on:{"on-change":e.changeSize,"on-page-size-change":e.changePagesize}})],1)],1)],1)],1),e._v(" "),0==e.haveSalesBill?i("Modal",{staticStyle:{"text-align":"center"},attrs:{title:"增值税专用发票",width:"50%"},on:{"on-cancel":e.cancel},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[i("Form",{attrs:{"label-position":"top"}},[i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[e._v("采购商名称:")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e.purchaserName))])],1),e._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[e._v("销售方名称: ")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e.supplierName))])],1)],1),e._v(" "),i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[e._v("发票金额(含税):")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e._f("money")(e.taxIncludedSum)))])],1),e._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[e._v("税额: ")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e._f("money")(e.taxSum)))])],1)],1),e._v(" "),i("Row",[i("Col",{attrs:{span:"24"}},[i("Table",{ref:"selection",attrs:{size:"small",height:"200",border:"",columns:e.columnsInvoice,data:e.invoiceList}})],1)],1)],1),e._v(" "),i("div",{staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[i("Page",{staticClass:"fr",staticStyle:{"margin-top":"4px"},attrs:{total:e.totalPages,"page-size":1,size:"small"},on:{"on-change":e.changeSizes,"on-page-size-change":e.changePagesizes}})],1)],1):e._e(),e._v(" "),1==e.haveSalesBill?i("Modal",{staticStyle:{"text-align":"center"},attrs:{title:"增值税专用发票",width:"50%"},on:{"on-cancel":e.cancel},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[i("Form",{attrs:{"label-position":"top"}},[i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[e._v("采购商名称:")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e.purchaserName))])],1),e._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[e._v("销售方名称: ")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e.supplierName))])],1)],1),e._v(" "),i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[e._v("发票金额(含税):")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e._f("money")(e.taxIncludedSum)))])],1),e._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[e._v("税额: ")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e._f("money")(e.taxSum)))])],1)],1),e._v(" "),i("Row",[i("Col",{attrs:{span:"24"}},[i("Table",{ref:"selection",attrs:{size:"small",columns:e.ncolumnsInvoice,data:e.ninvoiceList}})],1)],1)],1),e._v(" "),i("Form",{attrs:{"label-position":"top"}},[i("Row",[i("Col",{attrs:{span:"24"}},[i("p",{staticClass:"soltTitle margin-bottom-10"},[e._v("销售货物或者提供应税劳务清单")])])],1),e._v(" "),i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[e._v("采购商名称:")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e.purchaserName))])],1),e._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[e._v("销售方名称: ")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e.supplierName))])],1)],1),e._v(" "),i("Row",{staticClass:"expand-row"},[i("Col",{attrs:{span:"11"}},[i("Col",{attrs:{span:"11"}},[e._v("发票金额(含税):")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e._f("money")(e.taxIncludedSum)))])],1),e._v(" "),i("Col",{attrs:{span:"11",offset:"2"}},[i("Col",{attrs:{span:"11",offset:"2"}},[e._v("税额: ")]),e._v(" "),i("Col",{attrs:{span:"11"}},[e._v(e._s(e._f("money")(e.taxSum)))])],1)],1),e._v(" "),i("Row",[i("Col",{attrs:{span:"24"}},[i("Table",{ref:"selection",attrs:{size:"small",columns:e.columnsInvoice,data:e.invoiceList}})],1)],1)],1),e._v(" "),i("div",{staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[i("Page",{staticClass:"fr",attrs:{total:e.totalPages,"page-size":1,size:"small"},on:{"on-change":e.changeSizes,"on-page-size-change":e.changePagesizes}})],1)],1):e._e()],1)},o=[];n._withStripped=!0;var a={render:n,staticRenderFns:o};t.default=a},299:function(e,t,i){"use strict";function n(e){r||i(1129)}Object.defineProperty(t,"__esModule",{value:!0});var o=i(587),a=i.n(o);for(var s in o)"default"!==s&&function(e){i.d(t,e,function(){return o[e]})}(s);var c=i(1131),l=i.n(c),r=!1,p=i(1),v=n,u=p(a.a,l.a,!1,v,"data-v-abfa3288",null);u.options.__file="src/views/clearingTicket/application.vue",t.default=u.exports},333:function(e,t,i){"use strict";t.__esModule=!0;var n=i(334),o=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(e,t,i){return t in e?(0,o.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},334:function(e,t,i){e.exports={default:i(335),__esModule:!0}},335:function(e,t,i){i(336);var n=i(3).Object;e.exports=function(e,t,i){return n.defineProperty(e,t,i)}},336:function(e,t,i){var n=i(19);n(n.S+n.F*!i(11),"Object",{defineProperty:i(8).f})},587:function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=i(333),a=n(o),s=i(5),c=n(s),l=i(10),r=n(l);t.default={name:"",data:function(){var e,t=this;return e={totalPage:1,pageIndex:1,pageSize:10,totalPages:1,pageIndexs:1,pageSizes:1,userType:"",showBtn:!1,modal:!1,modal_loading:!1,loadingMorn:!1,searchValue:"",haveSalesBill:"",invoiceApplyItemList:[],purchaserName:"",supplierName:"",taxIncludedSum:"",taxSum:"",invoiceColumns:[{type:"index",title:"序号",width:60},{title:"开票申请单单号",key:"noticeNo",align:"center",sortable:!0,render:function(e,i){return e("span",[e("a",{style:{},on:{click:function(){t.lookDetail(i.row.invoiceApplicationId)}}},i.row.noticeNo)])}},{title:"订单编号",key:"contractCode"},{title:"订单名称",key:"contractName"},{title:"购货单位",sortable:!0,render:function(e,i){return 0==t.userType?e("span",i.row.purchaserName):1==t.userType?e("span",i.row.supplierName):void 0},renderHeader:function(e,i){return 0==t.userType?e("span",{domProps:{innerHTML:"购货单位"}}):1==t.userType?e("span",{domProps:{innerHTML:"销货单位"}}):void 0}},{title:"申请开票金额",key:"invoiceApplyMoney",render:function(e,t){return e("span",r.default.formatNum(t.row.invoiceApplyMoney,2))},sortable:!0},{title:"开票方式",key:"applyMethod"},{title:"状态",key:"state",sortable:!0,width:80,render:function(e,t){return 0==t.row.state?e("span","待提交"):1==t.row.state?e("span","待确认"):2==t.row.state?e("span","已驳回"):3==t.row.state?e("span","待开票"):4==t.row.state?e("span","登记中"):5==t.row.state?e("span","已登记"):6==t.row.state?e("span","已开票"):7==t.row.state?e("span","已退票"):void 0}},{title:"操作",key:"operation",render:function(e,i){if("0"===t.userType){if(0==i.row.state||2==i.row.state)return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.UpdateList(i.row.invoiceApplicationId,i.row.contractId,i.row.noticeNo)}}},"提交"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.editDetial(i.row.invoiceApplicationId)}}},"编辑"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.deleteList(i.row.invoiceApplicationId)}}},"删除")]);if(3==i.row.state)return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.fillInvoice(i.row.invoiceApplicationId)}}},"开票"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.invoiceDetail(i.row.invoiceApplicationId)}}},"登记")]);if(4==i.row.state||7==i.row.state)return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.submitInvoice(i.row.invoiceApplicationId)}}},"提交"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.getInvoiceDetail(i.row.invoiceApplicationId)}}},"维护")])}else if("1"===t.userType){if(1==i.row.state)return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.comfirmList(i.row.invoiceApplicationId,i.row.noticeNo,i.row.contractId)}}},"确认"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.rejectDetial(i.row.invoiceApplicationId,i.row.noticeNo,i.row.contractId)}}},"驳回")]);if(5==i.row.state)return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.comfirmInvoice(i.row.invoiceApplicationId)}}},"确认"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.outInvoice(i.row.invoiceApplicationId)}}},"退回")]);i.row.state}}}],invoiceData:[],noticeNo:"",contractCode:"",contractName:"",invoiceApplyMoney:"",columnsInvoice:[{title:"序号",type:"index",width:80,align:"center"},{title:"物资名称",key:"materialName",align:"center",width:200},{title:"规格型号",key:"spectype",align:"center",width:200},{title:"单位",key:"metricunitName",align:"center",width:200},{title:"数量",key:"settlementQuantity",align:"center",width:200},{title:"单价(未税)",key:"price",align:"center",width:200},{title:"金额(未税)",key:"taxExclusiveAmount",align:"center",width:200,render:function(e,t){return e("span",r.default.formatNum(t.row.settlementQuantity*t.row.price,2))}},{title:"税率",key:"itemTax",align:"center",width:200,render:function(e,t){return e("span",100*t.row.itemTax+"%")}},{title:"税额",key:"itemTaxAmount",align:"center",width:200,render:function(e,t){return e("span",r.default.formatNum(t.row.settlementQuantity*t.row.price*t.row.itemTax,2))}}],invoiceList:[],ncolumnsInvoice:[{title:"序号",width:80,align:"center"},{title:"物资名称",key:"materialName",align:"center",width:200},{title:"规格型号",align:"center",width:200},{title:"单位",align:"center",width:200},{title:"数量",align:"center",width:200},{title:"单价(未税)",align:"center",width:200},{title:"金额(未税)",align:"center",width:200},{title:"税率",align:"center",width:200},{title:"税额",align:"center",width:200}],ninvoiceList:[{materialName:"详见销货清单"}]},(0,a.default)(e,"haveSalesBill",""),(0,a.default)(e,"purchaserName",""),(0,a.default)(e,"supplierName",""),(0,a.default)(e,"invoiceApplyMoney",""),(0,a.default)(e,"taxedMoney",""),(0,a.default)(e,"invoiceApplicationId",""),e},mounted:function(){this.invoceList();var e=JSON.parse(c.default.get("userData"));this.userType=e.userType,"0"===this.userType?this.showBtn=!0:this.showBtn=!1},methods:{invoceList:function(){var e=this;this.loadingMorn=!0,this.$httpServer("/invoiceApplication/getInvoiceApplications.do",{pageNum:this.pageIndex,pageSize:this.pageSize,condition:this.noticeNo}).then(function(t){null==t.invoiceApplications?e.invoiceData=[]:e.invoiceData=t.invoiceApplications,e.totalPage=t.pageBean.totalCount,e.loadingMorn=!1})},searchInvoice:function(e){this.noticeNo=e,this.contractCode=e,this.contractName=e,this.invoiceApplyMoney=e,this.invoceList()},changeSize:function(e){this.pageIndex=e,this.invoceList()},changePagesize:function(e){this.pageSize=e,this.invoceList()},addApplication:function(){var e={applicationState:1001};this.$router.push({name:"application_add",query:e})},UpdateList:function(e,t,i){var n=this;this.$httpServer("/invoiceApplication/submitInvoiceApplication.do",{noticeId:e,contractId:t,noticeNo:i,state:1}).then(function(e){n.invoceList(),n.$Message.success("开票申请单已提交")})},comfirmList:function(e,t,i){var n=this;this.$httpServer("/invoiceApplication/comfirmInvoiceApplication.do",{invoiceApplicationId:e,noticeNo:t,contractId:i}).then(function(e){n.invoceList(),n.$Message.success("开票申请单已确认")})},rejectDetial:function(e,t,i){var n=this;this.$httpServer("/invoiceApplication/rejectInvoiceApplication.do",{invoiceApplicationId:e,noticeNo:t,contractId:i}).then(function(e){n.invoceList(),n.$Message.success("开票申请单已驳回")})},deleteList:function(e){var t=this;this.$httpServer("/invoiceApplication/deleteInvoiceApplication.do",{invoiceApplicationId:e}).then(function(e){t.invoceList(),t.$Message.success("开票申请单已删除")})},submitInvoice:function(e){var t=this;this.$httpServer("/invoiceRegistry/submitRegistry.do",{invoiceApplicationId:e}).then(function(e){t.invoceList(),t.$Message.success("发票已提交")})},getInvoiceDetail:function(e){var t={invoiceState:1002,invoiceApplicationId:e};this.$router.push({name:"invoiceAdd",query:t})},comfirmInvoice:function(e){var t=this;this.$httpServer("/invoiceRegistry/comfirmRegistry.do",{invoiceApplicationId:e}).then(function(e){t.invoceList(),t.$Message.success("发票已确认")})},outInvoice:function(e){var t=this;this.$httpServer("/invoiceRegistry/rebackRegistry.do",{invoiceApplicationId:e}).then(function(e){t.invoceList(),t.$Message.success("发票已退票")})},lookDetail:function(e){var t={invoiceApplicationId:e};this.$router.push({name:"application_detail",query:t})},editDetial:function(e){var t={applicationState:1002,invoiceApplicationId:e};this.$router.push({name:"application_add",query:t})},previewDetail:function(e){var t=this;this.modal=!0,this.$httpServer("/invoiceApplication/reviewInvoice.do",{pageNum:this.pageIndexs,pageSize:this.pageSizes,invoiceApplicationId:e}).then(function(e){t.invoiceList=e.invoiceReviewModel.invoiceApplicationItems,t.haveSalesBill=e.invoiceReviewModel.haveSalesBill,t.purchaserName=e.invoiceReviewModel.invoiceNew.purchaserName,t.supplierName=e.invoiceReviewModel.invoiceNew.supplierName,t.taxIncludedSum=e.invoiceReviewModel.invoiceNew.taxIncludedSum,t.taxSum=e.invoiceReviewModel.invoiceNew.taxSum,t.invoiceApplicationId=e.invoiceReviewModel.invoiceNew.invoiceApplictionId,t.totalPages=e.pageBean.totalPages})},fillInvoice:function(e){var t=this;this.$httpServer("/invoiceApplication/fillInvoiceData.do",{invoiceApplicationId:e}).then(function(e){t.invoceList()})},invoiceDetail:function(e){var t={invoiceState:1001,invoiceApplicationId:e};this.$router.push({name:"invoiceAdd",query:t})},changeSizes:function(e){var t=this;this.pageIndexs=e,this.modal=!0,this.$httpServer("/invoiceApplication/reviewInvoice.do",{pageNum:this.pageIndexs,pageSize:this.pageSizes,invoiceApplicationId:this.invoiceApplicationId}).then(function(e){t.invoiceList=e.invoiceReviewModel.invoiceApplicationItems,t.haveSalesBill=e.invoiceReviewModel.haveSalesBill,t.purchaserName=e.invoiceReviewModel.invoiceNew.purchaserName,t.supplierName=e.invoiceReviewModel.invoiceNew.supplierName,t.taxIncludedSum=e.invoiceReviewModel.invoiceNew.taxIncludedSum,t.taxSum=e.invoiceReviewModel.invoiceNew.taxSum,t.totalPages=e.pageBean.totalPages})},changePagesizes:function(e){this.pageSizes=e},cancel:function(){this.modal=!1}}}}});