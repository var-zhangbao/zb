webpackJsonp([29],{1084:function(t,e,a){var n=a(1085);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a(20)("3721570e",n,!1)},1085:function(t,e,a){e=t.exports=a(19)(void 0),e.push([t.i,'\n.margin-top-8[data-v-3eb0cc20] {\n  margin-top: 8px;\n}\n.margin-top-10[data-v-3eb0cc20] {\n  margin-top: 10px;\n}\n.margin-top-20[data-v-3eb0cc20] {\n  margin-top: 20px;\n}\n.margin-left-10[data-v-3eb0cc20] {\n  margin-left: 10px;\n}\n.margin-left-50[data-v-3eb0cc20] {\n  margin-left: 50px;\n}\n.margin-bottom-10[data-v-3eb0cc20] {\n  margin-bottom: 10px;\n}\n.margin-bottom-100[data-v-3eb0cc20] {\n  margin-bottom: 100px;\n}\n.margin-right-10[data-v-3eb0cc20] {\n  margin-right: 10px;\n}\n.margin-right-20[data-v-3eb0cc20] {\n  margin-right: 20px;\n}\n.padding-bottom-10[data-v-3eb0cc20] {\n  padding-bottom: 10px;\n}\n.padding-left-6[data-v-3eb0cc20] {\n  padding-left: 6px;\n}\n.padding-left-8[data-v-3eb0cc20] {\n  padding-left: 5px;\n}\n.padding-left-10[data-v-3eb0cc20] {\n  padding-left: 10px;\n}\n.padding-left-20[data-v-3eb0cc20] {\n  padding-left: 20px;\n}\n.height-100[data-v-3eb0cc20] {\n  height: 100%;\n}\n.height-120px[data-v-3eb0cc20] {\n  height: 100px;\n}\n.height-200px[data-v-3eb0cc20] {\n  height: 200px;\n}\n.height-492px[data-v-3eb0cc20] {\n  height: 492px;\n}\n.height-460px[data-v-3eb0cc20] {\n  height: 460px;\n}\n.line-gray[data-v-3eb0cc20] {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap[data-v-3eb0cc20] {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5[data-v-3eb0cc20] {\n  padding-left: 10px;\n}\n[v-cloak][data-v-3eb0cc20] {\n  display: none;\n}\n.clearfix[data-v-3eb0cc20]:after {\n  content: ".";\n  clear: both;\n  display: block;\n  height: 0;\n  overflow: hidden;\n  visibility: hidden;\n}\n.clearfix[data-v-3eb0cc20] {\n  zoom: 1;\n}\n.fl[data-v-3eb0cc20] {\n  float: left;\n}\n.fr[data-v-3eb0cc20] {\n  float: right;\n}\n.file[data-v-3eb0cc20] {\n  position: relative;\n  display: inline-block;\n  background: #D0EEFF;\n  border: 1px solid #99D3F5;\n  border-radius: 4px;\n  padding: 4px 12px;\n  overflow: hidden;\n  color: #1E88C7;\n  text-decoration: none;\n  text-indent: 0;\n  line-height: 20px;\n}\n.file input[data-v-3eb0cc20] {\n  position: absolute;\n  font-size: 100px;\n  right: 0;\n  top: 0;\n  opacity: 0;\n}\n.file[data-v-3eb0cc20]:hover {\n  background: #AADFFD;\n  border-color: #78C3F3;\n  color: #004974;\n  text-decoration: none;\n}\n.my-upload div table tr[data-v-3eb0cc20] {\n  font-size: 12px;\n}\n.greyCol[data-v-3eb0cc20] {\n  color: #999;\n}\n.expand-row[data-v-3eb0cc20] {\n  margin-bottom: 16px;\n  margin-top: 16px;\n  font-size: 12px;\n}\ntextarea.ivu-input[data-v-3eb0cc20] {\n  font-size: 12px;\n}\n.soltTitlel[data-v-3eb0cc20] {\n  line-height: 2;\n  padding: 0 16px;\n  margin-left: -16px;\n  margin-right: -19px;\n  font-weight: 900;\n  color: #464c5b;\n}\n.soltTitle[data-v-3eb0cc20] {\n  line-height: 1;\n  border-bottom: 1px solid #e3e8ee;\n  padding: 17px 16px;\n  margin-left: -16px;\n  margin-right: -19px;\n  font-weight: 900;\n  color: #464c5b;\n}\n.fileHidden[data-v-3eb0cc20] {\n  width: 6%;\n  position: absolute;\n  top: 10px;\n  opacity: 0;\n}\n.expand-row[data-v-3eb0cc20] {\n  margin-bottom: 16px;\n  margin-top: 16px;\n}\n',""])},1086:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"margin-bottom-10",attrs:{bordered:!1}},[a("Row",{attrs:{align:"middle",type:"flex"}},[a("Col",{attrs:{span:"8"}},[1001==this.$route.query.ticktState?a("p",{staticClass:"soltTitlel"},[t._v("新增结算单")]):t._e(),t._v(" "),1002==this.$route.query.ticktState?a("p",{staticClass:"soltTitlel"},[t._v("编辑结算单")]):t._e()]),t._v(" "),a("Col",{attrs:{span:"5",offset:"11"}},[a("Button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){t.saveTicket("formTickets")}}},[t._v("保存")]),t._v(" "),a("Button",{attrs:{type:"ghost"},on:{click:function(e){t.backlist()}}},[t._v("取消")])],1)],1)],1),t._v(" "),a("Card",{staticClass:"margin-bottom-10",attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"flag"}}),t._v(" 基本信息")],1),t._v(" "),a("Form",{ref:"formTickets",attrs:{"label-position":"top",model:t.formTickets,rules:t.ruleValidates}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"合同信息"}},[a("Input",{attrs:{placeholder:"合同信息"},model:{value:t.contractName,callback:function(e){t.contractName=e},expression:"contractName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"开票类型",prop:"invoiceType"}},[a("Select",{model:{value:t.formTickets.invoiceType,callback:function(e){t.$set(t.formTickets,"invoiceType",e)},expression:"formTickets.invoiceType"}},[a("Option",{attrs:{value:"1"}},[t._v("增值税专用发票")]),t._v(" "),a("Option",{attrs:{value:"2"}},[t._v("增值税普通发票")]),t._v(" "),a("Option",{attrs:{value:"3"}},[t._v("其他")])],1)],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"开票规则",prop:"ruleName"}},[a("Input",{attrs:{placeholder:"开票规则",disabled:""},model:{value:t.formTickets.ruleName,callback:function(e){t.$set(t.formTickets,"ruleName",e)},expression:"formTickets.ruleName"}},[a("Button",{attrs:{slot:"append",type:"ghost"},on:{click:t.openAcceptance},slot:"append"},[a("Icon",{attrs:{type:"plus"}})],1)],1)],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"开票金额"}},[a("Input",{attrs:{placeholder:"开票金额",disabled:""},model:{value:t.settlementMoney,callback:function(e){t.settlementMoney=e},expression:"settlementMoney"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"税额"}},[a("Input",{attrs:{placeholder:"税额",disabled:""},model:{value:t.settlementTaxMoney,callback:function(e){t.settlementTaxMoney=e},expression:"settlementTaxMoney"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"备注"}},[a("Input",{attrs:{type:"textarea",maxlength:255,placeholder:"备注255个字以内"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"soltTitle margin-bottom-10"},[a("Icon",{attrs:{type:"flag"}}),t._v(" 购货单位")],1)])],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"开票抬头"}},[a("Input",{attrs:{placeholder:"开票抬头",disabled:""},model:{value:t.getCompany.companyName,callback:function(e){t.$set(t.getCompany,"companyName",e)},expression:"getCompany.companyName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"纳税识别号"}},[a("Input",{attrs:{placeholder:"纳税识别号",disabled:""},model:{value:t.getCompany.companyCode,callback:function(e){t.$set(t.getCompany,"companyCode",e)},expression:"getCompany.companyCode"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"开户行"}},[a("Input",{attrs:{placeholder:"开户行",disabled:""},model:{value:t.getCompany.companyBank,callback:function(e){t.$set(t.getCompany,"companyBank",e)},expression:"getCompany.companyBank"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"开户账号"}},[a("Input",{attrs:{placeholder:"开户账号",disabled:""},model:{value:t.getCompany.companyBankAccount,callback:function(e){t.$set(t.getCompany,"companyBankAccount",e)},expression:"getCompany.companyBankAccount"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"地址"}},[a("Input",{attrs:{placeholder:"地址",disabled:""},model:{value:t.getCompany.companyAddress,callback:function(e){t.$set(t.getCompany,"companyAddress",e)},expression:"getCompany.companyAddress"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"电话"}},[a("Input",{attrs:{placeholder:"电话",disabled:""},model:{value:t.getCompany.companyTel,callback:function(e){t.$set(t.getCompany,"companyTel",e)},expression:"getCompany.companyTel"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"soltTitle margin-bottom-10"},[a("Icon",{attrs:{type:"flag"}}),t._v(" 销货单位")],1)])],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"销货单位"}},[a("Input",{attrs:{placeholder:"销货单位",disabled:""},model:{value:t.supplierName,callback:function(e){t.supplierName=e},expression:"supplierName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"纳税识别号"}},[a("Input",{attrs:{placeholder:"纳税识别号",disabled:""},model:{value:t.supplierCompanyCode,callback:function(e){t.supplierCompanyCode=e},expression:"supplierCompanyCode"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"开户行"}},[a("Input",{attrs:{placeholder:"开户行",disabled:""},model:{value:t.supplierBankName,callback:function(e){t.supplierBankName=e},expression:"supplierBankName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"银行账号"}},[a("Input",{attrs:{placeholder:"银行账号",disabled:""},model:{value:t.supplierBankAccount,callback:function(e){t.supplierBankAccount=e},expression:"supplierBankAccount"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"地址"}},[a("Input",{attrs:{placeholder:"地址",disabled:""},model:{value:t.supplierCompanyAddr,callback:function(e){t.supplierCompanyAddr=e},expression:"supplierCompanyAddr"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"电话"}},[a("Input",{attrs:{placeholder:"电话",disabled:""},model:{value:t.supplierCompanyTel,callback:function(e){t.supplierCompanyTel=e},expression:"supplierCompanyTel"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"soltTitle margin-bottom-10"},[a("Icon",{attrs:{type:"flag"}}),t._v("开票明细\n                        "),a("a",{staticClass:"fr",attrs:{href:"javascript:;"},on:{click:function(e){t.deleDetail()}}},[a("Icon",{attrs:{type:"plus"}}),t._v(" 删除")],1),t._v(" "),a("a",{staticClass:"fr margin-right-20",attrs:{href:"javascript:;"},on:{click:function(e){t.addModal()}}},[a("Icon",{attrs:{type:"plus"}}),t._v(" 添加")],1),t._v(" "),a("a",{staticClass:"fr margin-right-20",attrs:{href:"javascript:;"},on:{click:function(e){t.updateInfo=!0}}},[a("Icon",{attrs:{type:"plus"}}),t._v(" 导入")],1)],1)]),t._v(" "),a("Col",{attrs:{span:"24"}},[a("Table",{ref:"selection",attrs:{size:"small",height:"200",border:"",columns:t.columns2,data:t.invoiceSettlementData},on:{"on-selection-change":t.selectModel,"on-row-click":t.clickRow}})],1)],1)],1),t._v(" "),a("Modal",{attrs:{"mask-closable":!1,title:"开票规则信息",width:"50%"},on:{"on-cancel":t.cancel},model:{value:t.acceptanceInfoMd,callback:function(e){t.acceptanceInfoMd=e},expression:"acceptanceInfoMd"}},[a("Card",[a("div",[a("RadioGroup",{staticStyle:{width:"100%"},attrs:{vertical:""},on:{"on-change":t.onChangeRadio},model:{value:t.vertical,callback:function(e){t.vertical=e},expression:"vertical"}},t._l(t.getCompanys,function(e,n){return a("Row",{key:e.ruleId,staticClass:"code-row-bg",attrs:{type:"flex",justify:"center",align:"middle"}},[a("Col",{attrs:{span:"1"}},[a("Radio",{attrs:{label:e.ruleId,size:"large"}},[a("i",{staticStyle:{display:"none"}},[t._v(" "+t._s(e.ruleId))])])],1),t._v(" "),a("Col",{attrs:{span:"23"}},[a("Row",{staticClass:"expand-row"},[a("Col",{attrs:{span:"11"}},[a("Col",{attrs:{span:"11",offset:"2"}},[t._v("开票规则模板:")]),t._v(" "),a("Col",{attrs:{span:"11"}},[t._v(t._s(e.ruleName))])],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("Col",{attrs:{span:"11",offset:"2"}},[t._v("模板对应客户: ")]),t._v(" "),a("Col",{attrs:{span:"11"}},[t._v(t._s(e.companyName))])],1)],1),t._v(" "),a("Row",{staticClass:"expand-row"},[a("Col",{attrs:{span:"11"}},[a("Col",{attrs:{span:"11",offset:"2"}},[t._v("客户税号:")]),t._v(" "),a("Col",{attrs:{span:"11"}},[t._v(t._s(e.taxNo))])],1)],1)],1)],1)}))],1)]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",loading:t.modal_loading},on:{click:function(e){t.sureAcceptance()}}},[t._v("确定")]),t._v(" "),a("Button",{attrs:{type:"ghost",loading:t.modal_loading},on:{click:function(e){t.acceptanceInfoMd=!1}}},[t._v("取消")])],1)],1),t._v(" "),a("Modal",{attrs:{"mask-closable":!1,title:t.digType?"编辑开票明细":"新增开票明细",width:"50%"},on:{"on-cancel":t.cancel},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[a("Form",{ref:"formDetail",attrs:{"label-position":"top",model:t.formDetail,rules:t.ruleValidate}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"物资名称",prop:"materialName"}},[a("Input",{attrs:{placeholder:"物资名称"},model:{value:t.formDetail.materialName,callback:function(e){t.$set(t.formDetail,"materialName",e)},expression:"formDetail.materialName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"规格型号",prop:"spectype"}},[a("Input",{attrs:{placeholder:"规格型号"},model:{value:t.formDetail.spectype,callback:function(e){t.$set(t.formDetail,"spectype",e)},expression:"formDetail.spectype"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"单位"}},[a("Input",{attrs:{placeholder:"单位"},model:{value:t.formDetail.metricunitName,callback:function(e){t.$set(t.formDetail,"metricunitName",e)},expression:"formDetail.metricunitName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"数量",prop:"settlementQuantity"}},[a("Input",{attrs:{placeholder:"数量"},on:{"on-blur":function(e){t.onAmount()}},model:{value:t.formDetail.settlementQuantity,callback:function(e){t.$set(t.formDetail,"settlementQuantity",e)},expression:"formDetail.settlementQuantity"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"单价(未税)",prop:"price"}},[a("Input",{attrs:{placeholder:"单价(未税)"},on:{"on-blur":function(e){t.onAmount()}},model:{value:t.formDetail.price,callback:function(e){t.$set(t.formDetail,"price",e)},expression:"formDetail.price"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"金额(未税)"}},[a("Input",{attrs:{placeholder:"金额(未税)",disabled:""},model:{value:t.formDetail.taxExclusiveAmount,callback:function(e){t.$set(t.formDetail,"taxExclusiveAmount",e)},expression:"formDetail.taxExclusiveAmount"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"税率",prop:"itemTax"}},[a("Select",{on:{"on-change":t.onSelect},model:{value:t.formDetail.itemTax,callback:function(e){t.$set(t.formDetail,"itemTax",e)},expression:"formDetail.itemTax"}},[a("Option",{attrs:{value:"0.03"}},[t._v("3%")]),t._v(" "),a("Option",{attrs:{value:"0.06"}},[t._v("6%")]),t._v(" "),a("Option",{attrs:{value:"0.11"}},[t._v("11%")]),t._v(" "),a("Option",{attrs:{value:"0.17"}},[t._v("17%")])],1)],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"税额",prop:"itemTaxAmount"}},[a("Input",{attrs:{placeholder:"税额",disabled:""},model:{value:t.formDetail.itemTaxAmount,callback:function(e){t.$set(t.formDetail,"itemTaxAmount",e)},expression:"formDetail.itemTaxAmount"}})],1)],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",loading:t.modal_loading},on:{click:function(e){t.sure("formDetail")}}},[t._v(t._s((t.digType,"保存")))]),t._v(" "),a("Button",{attrs:{type:"ghost",loading:t.modal_loading},on:{click:t.cancel}},[t._v("取消")])],1)],1),t._v(" "),a("Modal",{attrs:{"mask-closable":!1,title:"导入开票明细"},model:{value:t.updateInfo,callback:function(e){t.updateInfo=e},expression:"updateInfo"}},[a("Form",{attrs:{"label-position":"top"}},[a("Row",[a("Col",{attrs:{span:"24"}},[a("FormItem",[t._v("\n                            1、"),a("a",{on:{click:t.uploadFile}},[t._v("点击下载")]),t._v("《开票明细模板》\n                        ")])],1),t._v(" "),a("Col",{attrs:{span:"24"}},[a("FormItem",[t._v("\n                            2、填写模板文件选择文件，开始导入\n                        ")])],1),t._v(" "),a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"my-upload"},[a("a",{staticClass:"file",attrs:{href:"javascript:;",disabled:t.flieDisabled},on:{change:function(e){t.upFile(e)}}},[t._v("选择文件\n                                "),a("input",{attrs:{type:"file",name:"",id:""}})]),t._v(" "),a("div",[a("table",t._l(t.filesList,function(e,n){return a("tr",[a("td",{staticStyle:{padding:"0 10px"}},[t._v(t._s(n+1))]),t._v(" "),a("td",{staticStyle:{padding:"0 10px"}},[t._v(t._s(e.name))]),t._v(" "),a("td",{staticStyle:{padding:"0 10px"}},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.delFile(n)}}},[t._v("删除")])])])}))])])])],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.sureItem()}}},[t._v("确认")]),t._v(" "),a("Button",{attrs:{type:"ghost"},on:{click:function(e){t.updateInfo=!1}}},[t._v("取消")])],1)],1)],1)],1)},o=[];n._withStripped=!0;var l={render:n,staticRenderFns:o};e.default=l},302:function(t,e,a){"use strict";function n(t){c||a(1084)}Object.defineProperty(e,"__esModule",{value:!0});var o=a(585),l=a.n(o);for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);var s=a(1086),r=a.n(s),c=!1,p=a(4),m=n,u=p(l.a,r.a,!1,m,"data-v-3eb0cc20",null);u.options.__file="src/views/tickets/purchasersTicket.vue",e.default=u.exports},585:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=a(39),l=n(o),i=a(111),s=n(i);e.default={name:"",data:function(){return{vertical:"apple",myjson:{},getCompanys:[],outputCompanyId:"",single:!1,unitsMd:!1,unitsEdit:!1,acceptanceInfoMd:!1,modal1:!1,loading:!1,modal_loading:!1,updateInfo:!1,contractSearch:"",acceptanceSearch:"",digType:!1,contractName:"",formTickets:{invoiceType:"",ruleName:""},ruleValidates:{ruleName:[{required:!0,message:"请选择规则模板名称",trigger:"change"}],invoiceType:[{required:!0,message:"请选择开票类型",trigger:"change"}]},invoiceRuleId:"",settlementMoney:"",settlementTaxMoney:"",description:"",companyId:"",num:0,formDetail:{materialName:"",spectype:"",metricunitName:"",settlementQuantity:"",price:"",taxExclusiveAmount:"",itemTax:"",itemTaxAmount:""},addForm:{companyName:"",companyCode:"",companyBank:"",companyBankAccount:"",companyAddress:"",companyTel:""},editForm:{companyName:"",companyCode:"",companyBank:"",companyBankAccount:"",companyAddress:"",companyTel:""},getCompany:{companyName:"",companyCode:"",companyBank:"",companyBankAccount:"",companyAddress:"",companyTel:"",purchaserId:""},ruleValidate:{materialName:[{required:!0,message:"请输入物资名称",trigger:"blur"}],spectype:[{required:!0,message:"请输入规格型号",trigger:"blur"}],settlementQuantity:[{required:!0,message:"数量请输入数字",trigger:"blur",pattern:/^[0-9]*$/}],price:[{required:!0,message:"单价请输入数字",trigger:"blur",pattern:/^[0-9]*$/}],itemTax:[{required:!0,message:"请选择税率",trigger:"change",pattern:/.+/}]},columns2:[{type:"selection",width:60,align:"center",fixed:"left"},{title:"物资名称",key:"materialName",align:"center",width:200},{title:"规格型号",key:"spectype",align:"center",width:200},{title:"单位",key:"metricunitName",align:"center",width:200},{title:"数量",key:"settlementQuantity",align:"center",width:200},{title:"单价(未税)",key:"price",align:"center",width:200},{title:"金额(未税)",key:"taxExclusiveAmount",align:"center",width:200},{title:"税率",key:"itemTax",align:"center",width:200,render:function(t,e){return t("span",100*e.row.itemTax+"%")}},{title:"税额",key:"itemTaxAmount",align:"center",width:200}],invoiceSettlementData:[],data1:[],acceptanceColumns:[],acceptanceData:[],supplierId:"",supplierName:"",supplierCompanyCode:"",supplierBankName:"",supplierBankAccount:"",supplierCompanyAddr:"",supplierCompanyTel:"",invoiceSettlementStr:{},invoiceSettlementItemStr:{},invoiceSettlementId:"",settlementNo:"",file:"",list:[],filesList:[],flieDisabled:!1,deleteList:[],materIndex:""}},mounted:function(){this.init()},watch:{$route:function(){this.init()},filesList:function(t){t.length>=5?this.flieDisabled=!0:this.flieDisabled=!1}},methods:{init:function(){switch(this.$route.query.ticktState){case 1001:this.getMains();break;case 1002:this.invoiceSettlementId=this.$route.query.settlementId,this.getInvoiceSettlement()}},getMains:function(){var t=this;this.$httpServer("/outputSettlementBill/renderSettlementBillAdd.do",{}).then(function(e){t.supplierName=e.supplierName,t.supplierCompanyCode=e.supplierCompanyCode,t.supplierBankName=e.supplierBankName,t.supplierBankAccount=e.supplierBankAccount,t.supplierCompanyAddr=e.supplierCompanyAddr,t.supplierCompanyTel=e.supplierCompanyTel,t.supplierId=e.id})},getInvoiceSettlement:function(){var t=this;this.$httpServer("/outputSettlementBill/renderInvoiceSettlementUpdate.do",{invoiceSettlementId:this.invoiceSettlementId}).then(function(e){t.contractName=e.outputSettlementBill.contractName,t.formTickets.invoiceType=e.outputSettlementBill.invoiceType.toString(),t.settlementMoney=e.outputSettlementBill.settlementMoney,t.formTickets.ruleName=e.ruleName,t.settlementNo=e.outputSettlementBill.settlementNo,t.invoiceRuleId=e.outputSettlementBill.invoiceRuleId,t.settlementTaxMoney=e.outputSettlementBill.settlementTaxMoney,t.description=e.outputSettlementBill.description,t.getCompany.companyName=e.outputSettlementBill.purchaserName,t.getCompany.companyCode=e.outputSettlementBill.purchaserCompanyCode,t.getCompany.companyBank=e.outputSettlementBill.purchaserBankName,t.getCompany.companyBankAccount=e.outputSettlementBill.purchaserBankAccount,t.getCompany.companyAddress=e.outputSettlementBill.purchaserCompanyAddr,t.getCompany.companyTel=e.outputSettlementBill.purchaserCompanyTel,t.supplierName=e.outputSettlementBill.supplierName,t.supplierCompanyCode=e.outputSettlementBill.supplierCompanyCode,t.supplierCompanyAddr=e.outputSettlementBill.supplierCompanyAddr,t.supplierCompanyTel=e.outputSettlementBill.supplierCompanyTel,t.supplierBankName=e.outputSettlementBill.supplierBankName,t.supplierBankAccount=e.outputSettlementBill.supplierBankAccount,t.invoiceSettlementData=e.outputSettlementItems})},openAcceptance:function(){var t=this;this.acceptanceInfoMd=!0,this.$httpServer("/outputInvoiceRule/getRuleInfos.do",{}).then(function(e){t.getCompanys=e})},onChangeRadio:function(t){console.log(t);for(var e=0;e<this.getCompanys.length;e++)this.getCompanys[e].ruleId==t&&(this.myjson=this.getCompanys[e]);console.log(this.myjson)},sureAcceptance:function(){var t=this;this.acceptanceInfoMd=!1,this.formTickets.ruleName=this.myjson.ruleName,this.invoiceRuleId=this.myjson.ruleId,this.companyId=this.myjson.companyId,this.$httpServer("/outputCompany/getOutputCompanyById.do",{outputCompanyId:this.companyId}).then(function(e){t.getCompany.companyName=e.companyName,t.getCompany.companyCode=e.companyCode,t.getCompany.companyBank=e.companyBank,t.getCompany.companyBankAccount=e.companyBankAccount,t.getCompany.companyAddress=e.companyAddress,t.getCompany.companyTel=e.companyTel,t.getCompany.purchaserId=e.id})},backlist:function(){this.$router.go(-1)},addModal:function(){this.modal1=!0,this.digType=!1,this.$refs.formDetail.resetFields()},sure:function(t){var e=this;this.$refs[t].validate(function(t){if(t){if(0==e.digType){e.modal1=!1,e.formDetail.id=e.num++,e.invoiceSettlementData.push(e.formDetail),e.$Message.success("保存成功");for(var a=0,n=0,o=0;o<e.invoiceSettlementData.length;o++)e.invoiceSettlementData[o].invoiceMoney=e.invoiceSettlementData[o].taxExclusiveAmount+e.invoiceSettlementData[o].itemTaxAmount,a=Number(a)+Number(e.invoiceSettlementData[o].invoiceMoney),n=Number(n)+Number(e.invoiceSettlementData[o].itemTaxAmount),e.settlementMoney=a,e.settlementTaxMoney=n;return e.formDetail={}}var l=(0,s.default)({},e.formDetail);console.log(l);for(var o=0;o<e.invoiceSettlementData.length;o++)e.invoiceSettlementData.splice(e.materIndex,1,l);e.modal1=!1,e.$Message.success("修改成功");for(var a=0,n=0,o=0;o<e.invoiceSettlementData.length;o++)e.invoiceSettlementData[o].invoiceMoney=e.invoiceSettlementData[o].taxExclusiveAmount+e.invoiceSettlementData[o].itemTaxAmount,a=Number(a)+Number(e.invoiceSettlementData[o].invoiceMoney),n=Number(n)+Number(e.invoiceSettlementData[o].itemTaxAmount),e.settlementMoney=a,e.settlementTaxMoney=n}else e.$Message.error("请填写开票明细!")})},clickRow:function(t,e){console.log(t),this.materIndex=e,this.formDetail=t,this.formDetail.itemTax=t.itemTax.toString(),this.modal1=!0,this.digType=!0,this.$refs.formDetail.resetFields()},selectModel:function(t){console.log(t),this.deleteList=t},deleDetail:function(){if(console.log(this.invoiceSettlementData),0!=this.deleteList.length){if(this.deleteList.length==this.invoiceSettlementData.length)this.invoiceSettlementData=[];else for(var t=0;t<this.invoiceSettlementData.length;t++)for(var e=0;e<this.deleteList.length;e++)if(this.invoiceSettlementData[t].id==this.deleteList[e].id){this.$Message.success("删除成功"),this.invoiceSettlementData.splice(t,this.deleteList.length);break}}else this.$Message.warning("请选择要删除明细")},onAmount:function(){NaN!=this.formDetail.itemTaxAmount?(this.formDetail.taxExclusiveAmount=this.formDetail.settlementQuantity*this.formDetail.price,this.formDetail.itemTaxAmount=this.formDetail.taxExclusiveAmount*this.formDetail.itemTax):(this.formDetail.taxExclusiveAmount=this.formDetail.settlementQuantity*this.formDetail.price,this.formDetail.itemTaxAmount="")},onSelect:function(){this.formDetail.itemTaxAmount=this.formDetail.taxExclusiveAmount*this.formDetail.itemTax},saveTicket:function(t){var e=this;this.$refs[t].validate(function(t){if(t){e.loading=!0;var a=new FormData;e.invoiceSettlementStr={settlementId:e.invoiceSettlementId,contractName:e.contractName,invoiceType:e.formTickets.invoiceType,invoiceRuleId:e.invoiceRuleId,settlementMoney:e.settlementMoney,settlementTaxMoney:e.settlementTaxMoney,description:e.description,purchaserId:e.getCompany.purchaserId,purchaserName:e.getCompany.companyName,purchaserCompanyCode:e.getCompany.companyCode,purchaserCompanyAddr:e.getCompany.companyAddress,purchaserCompanyTel:e.getCompany.companyTel,purchaserBankName:e.getCompany.companyBank,purchaserBankAccount:e.getCompany.companyBankAccount,supplierId:e.supplierId,supplierName:e.supplierName,supplierCompanyCode:e.supplierCompanyCode,supplierCompanyAddr:e.supplierCompanyAddr,supplierCompanyTel:e.supplierCompanyTel,supplierBankName:e.supplierBankName,supplierBankAccount:e.supplierBankAccount},a.append("flag",0),a.append("invoiceSettlementStr",(0,l.default)(e.invoiceSettlementStr)),a.append("invoiceSettlementItemStr",(0,l.default)(e.invoiceSettlementData)),1001==e.$route.query.ticktState?e.$fdServer("/outputSettlementBill/addInvoiceSettlementBill.do",a).then(function(t){console.log(t),200==t.status?(e.$Message.success("保存成功"),e.loading=!1,e.backlist()):e.$Message.error("保存失败")}):e.$fdServer("/outputSettlementBill/updateInvoiceSettlement.do",a).then(function(t){console.log(t),200==t.status?(e.$Message.success("保存成功"),e.backlist()):e.$Message.error("保存失败")})}else e.$Message.error("请填写一键开票信息!")})},uploadFile:function(){window.open("/outputSettlementItem/exportItemExcelModule.do")},upFile:function(t){this.file=t.target.files[0];var e=t.target.files,a=[];Array.prototype.push.apply(a,e);for(var n=0;n<a.length;n++)this.filesList.push(a[n])},delFile:function(t){this.filesList.splice(t,1)},sureItem:function(){var t=this;this.updateInfo=!1;for(var e=new FormData,a=0;a<this.filesList.length;a++)e.append("file",this.filesList[a]);this.$fdServer("/outputSettlementItem/importItem.do",e).then(function(a){t.$fdServer("/outputSettlementItem/importItem.do",e).then(function(e){if(200==e.status){t.$Message.success("导入成功"),t.invoiceSettlementData=e.result;for(var a=0,n=0,o=0;o<t.invoiceSettlementData.length;o++)a=Number(a)+Number(t.invoiceSettlementData[o].taxExclusiveAmount),n=Number(n)+Number(t.invoiceSettlementData[o].itemTaxAmount),t.settlementMoney=a,t.settlementTaxMoney=n;t.updateInfo=!1,t.filesList=[]}else t.updateInfo=!0,t.$Message.error("导入失败")})})},cancel:function(){this.modal1=!1,this.acceptanceInfoMd=!1}}}}});