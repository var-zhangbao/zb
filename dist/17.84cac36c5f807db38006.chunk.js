webpackJsonp([17],{279:function(t,e,a){"use strict";function r(t){c||a(953)}Object.defineProperty(e,"__esModule",{value:!0});var o=a(537),n=a.n(o);for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);var l=a(955),s=a.n(l),c=!1,d=a(4),u=r,m=d(n.a,s.a,!1,u,null,null);m.options.__file="src/views/contract/addContract.vue",e.default=m.exports},349:function(t,e,a){"use strict";e.__esModule=!0;var r=a(350),o=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(t,e,a){return e in t?(0,o.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},350:function(t,e,a){t.exports={default:a(351),__esModule:!0}},351:function(t,e,a){a(352);var r=a(0).Object;t.exports=function(t,e,a){return r.defineProperty(t,e,a)}},352:function(t,e,a){var r=a(9);r(r.S+r.F*!a(11),"Object",{defineProperty:a(10).f})},537:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=a(39),n=r(o),i=a(111),l=r(i),s=a(22),c=r(s),d=a(349),u=r(d),m=a(15),p=r(m);e.default={name:"",data:function(){var t,e=this,a=function(t,a,r){if(""===a)r(new Error("请输入"+t.valiName));else{/^[\d,]+\.?\d{0,2}$/.test(a)?e.contractForm.currencyMoney=p.default.formatNum(a,2):r(new Error("请输入正确的金额格式")),r()}},r=function(t,a,r){if(""===a)r(new Error("请输入"+t.valiName));else{/^[\d,]+\.?\d{0,2}$/.test(a)?e.contractForm.billMoney=p.default.formatNum(a,2):r(new Error("请输入正确的金额格式")),r()}},o=function(t,a,r){if(""===a)r(new Error("请输入"+t.valiName));else{/^[\d,]+\.?\d{0,2}$/.test(a)?e.detailForm.price=p.default.formatNum(a,2):r(new Error("请输入正确的金额格式")),r()}},n=function(t,a,r){if(""===a)r(new Error("请输入"+t.valiName));else{/^[\d,]+\.?\d{0,2}$/.test(a)?e.detailForm.sumMoney=p.default.formatNum(a,2):r(new Error("请输入正确的金额格式")),r()}},i=function(t,e,a){""===e?a(new Error("请选择"+t.valiName)):a()},l=function(t,e,a){console.log(e),""===e?a(new Error("请选择"+t.valiName)):a()},s=function(t,e,a){""===e?a(new Error("请选择"+t.valiName)):a()},c=function(t,e,a){console.log(e),console.log(t),""===e?a(new Error("请选择"+t.valiName)):a()},d=function(t,e,a){""===e?a(new Error("请选择"+t.valiName)):a()},m=function(t,a,r){if(""===a)r(new Error("请输入"+t.valiName));else{/^[\d,]+\.?\d{0,2}$/.test(a)?(console.log(e.detailForm.price),e.detailForm.sumMoney=p.default.formatNum(p.default.formatFalNum(e.detailForm.price)*parseFloat(e.detailForm.needQuantity),2)):r(new Error("请输入正确的金额格式")),r()}},f=function(t,e,a){""===e?a(new Error("请选择"+t.valiName)):a()};return t={baseUrl:"",modal1:!1,modal2:!1,modal_loading:!1,flieDisabled:!1,loading1:!1,contractForm:{contractName:"",contractCode:"",purchaserName:"",supplierId:"",supplierName:"",director:"",sampleAttribution:"",salesContactMan:"",taxRate:"",settingMethod:"",orderNature:"",engineers:"",projectManager:"",deliveryAddress:"",currencyMoney:0,billMoney:0,sampleDemoBillNo:"",remarks:""},detailForm:{materialName:"",spectype:"",figureNo:"",metricunitName:"",price:"",needQuantity:"",sumMoney:"",supplyDate:""},ruleValidate:{contractCode:[{required:!0,message:"订单编号不可为空",trigger:"blur"}],contractName:[{required:!0,message:"请输入订单名称",trigger:"blur"}],currencyMoney:[{validator:a,required:!0,trigger:"blur",valiName:"未税订单金额"}],billMoney:[{validator:r,required:!0,trigger:"blur",valiName:"订单总金额"}],sampleAttribution:[{validator:i,required:!0,trigger:"change",valiName:"样件归属地"}],purchaserName:[{validator:l,required:!0,trigger:"change",valiName:"采购商名称"}],director:[{validator:s,required:!0,trigger:"change",valiName:"收货人"}],deliveryAddress:[{validator:c,required:!0,trigger:"change",valiName:"收货地址"}],supplierId:[{validator:d,required:!0,trigger:"change",valiName:"供应商名称"}],salesContactMan:[{validator:f,required:!0,trigger:"change",valiName:"卖方联系人"}],taxRate:[{validator:f,required:!0,trigger:"change",valiName:"税率"}]},ruleValidate2:{materialName:[{required:!0,message:"请输入物资名称名称",trigger:"blur"}],spectype:[{required:!0,message:"请输入材料规格型号",trigger:"blur"}],metricunitName:[{required:!0,message:"请输入计量单位",trigger:"blur"}],price:[{validator:o,required:!0,trigger:"blur",valiName:"单价(未税)"}],sumMoney:[{validator:n,required:!0,trigger:"blur",valiName:"总价(未税)"}],needQuantity:[{required:!0,validator:m,trigger:"blur",valiName:"需求数量"}],supplyDate:[{required:!0,type:"date",message:"请选择到货日期",trigger:"change"}],figureNo:[{validator:function(t,e,a){""===e?a(new Error("请输入"+t.valiName)):a()},required:!0,trigger:"blur",valiName:"图号"}]},columns2:[{type:"selection",width:60,align:"center",fixed:"left"},{type:"index",title:"序号",width:60},{title:"物资名称",key:"materialName",width:150},{title:"材料规格型号",key:"spectype",width:150},{title:"图号",key:"figureNo",width:150},{title:"计量单位",key:"metricunitName",width:150},{title:"需求数量",key:"needQuantity",width:150},{title:"单价(未税)",key:"price",width:150,render:function(t,e){return t("span",p.default.formatNum(e.row.price,2))}},{title:"总价(未税)",key:"sumMoney",width:150,render:function(t,e){return t("span",p.default.formatNum(e.row.sumMoney))}},{title:"到货日期",key:"supplyDate",width:150,render:function(t,e){return t("span",p.default.format(e.row.supplyDate))}}],material:[],contypeList:[],currencyList:[],orgList:[],userList:[],vitalList:[],file:[],typeSelect:!1,digType:!1,deleteList:[],num:0,contractId:"",orgId:"",submituserName:"",materIndex:"",deleteId:{id:""},fileList:[]},(0,u.default)(t,"orgId",""),(0,u.default)(t,"submitUserIds",""),(0,u.default)(t,"jValue",""),(0,u.default)(t,"purchaserList",[]),(0,u.default)(t,"consigneeList",[]),(0,u.default)(t,"sampleList",[]),(0,u.default)(t,"vitalList",[]),(0,u.default)(t,"SellerList",[]),(0,u.default)(t,"taxRateList",[]),(0,u.default)(t,"settlementList",[]),(0,u.default)(t,"orderNatuteList",[]),(0,u.default)(t,"engineersList",[]),(0,u.default)(t,"projectManagerList",[]),(0,u.default)(t,"addressList",[]),(0,u.default)(t,"fileFlag",[]),(0,u.default)(t,"supplierName",""),t},mounted:function(){this.getOtherInfo(),this.getVitalList(),this.init()},methods:{init:function(){switch(this.$route.query.contract_State.toString()){case"1001":this.creatContractCode(),this.typeSelect=!1;break;case"1002":this.typeSelect=!0,this.contractId=this.$route.query.contract_Id,this.getMainContract(),this.getMainMaterial(),this.getMainFileList()}},creatContractCode:function(){var t=this;this.$httpServer("/contractCore/generateContractCode.do",{}).then(function(e){t.contractForm.contractCode=e.result})},getMainContract:function(){var t=this,e={contractId:this.contractId};this.$httpServer("/contractCore/getContract.do",e).then(function(e){t.contractForm=e.result,t.contractForm.engineers=e.result.engineers,t.contractForm.deliveryAddress=e.result.deliveryAddress,t.contractForm.salesContactMan=e.result.salesContactMan,console.log(e.result.deliveryAddress),t.supplierName=e.result.supplierName,t.orgId=e.result.orgId,t.contractForm.currencyMoney=p.default.formatNum(e.result.currencyMoney),t.getEngineer(t.contractForm.engineers),t.getProjectManager(t.contractForm.projectManager)})},getMainMaterial:function(){var t=this,e={contractId:this.contractId};this.$httpServer("/contractItem/contractItemList.do",e).then(function(e){t.material=e.result;for(var a=0;a<t.material.length;a++){var r=new Date(t.material[a].supplyDate),o=r.getFullYear()+"-"+p.default.repairZ(r.getMonth()+1)+"-"+p.default.repairZ(r.getDate());t.material[a].supplyDate=o}})},getMainFileList:function(){var t=this,e={contractId:this.contractId};this.$httpServer("/contractFile/FileLsit.do",e).then(function(e){console.log(e),t.fileList=e.result,t.fileFlag=t.fileList.map(function(t){return t.flag})})},showDig:function(){this.modal1=!0,this.digType=!1,this.$refs.detailForm.resetFields()},ok:function(){},cancel:function(){this.modal1=!1},backlist:function(){this.$router.go(-1)},getOtherInfo:function(){var t=this;this.$httpServer("/maintenancedict/getSysDict.do",{}).then(function(e){t.purchaserList=e.result.PN,t.consigneeList=e.result.RM,t.sampleList=e.result.SA,t.taxRateList=e.result.TR,t.settlementList=e.result.SM,t.orderNatuteList=e.result.ON,t.addressList=e.result.DA})},getSellerList:function(t){var e=this;this.$httpServer("/maintenancedict/getUserByOrgId.do",{supplierId:t}).then(function(t){e.SellerList=t.userList})},getEngineer:function(t){var e=this;if(""!==t){this.loading1=!0;var a={engineers:t};this.$httpServer("/contractCore/queryEngineersByLike.do",a).then(function(t){console.log(t),e.engineersList=t.result.list,null!==e.engineersList||e.engineersList!==[]?e.loading1=!1:e.engineersList=[]})}else this.engineersList=[]},getProjectManager:function(t){var e=this;if(""!==t){this.loading1=!0;var a={projectManager:t};this.$httpServer("/contractCore/queryProjectManagerByLike.do",a).then(function(t){console.log(t),e.projectManagerList=t.result.list,null!==e.projectManagerList||e.projectManagerList!==[]?e.loading1=!1:e.projectManagerList=[]})}else this.projectManagerList=[]},chooseSuper:function(t){console.log(t),t.label=t.label||this.supplierName,this.contractForm.supplierName=t.label,this.contractForm.supplierId=t.value,this.getSellerList(t.value)},choosePerson:function(t){console.log(t)},chooseFactory:function(t){console.log(t),this.detailForm.factory=t.label,this.detailForm.factoryId=t.value,this.orgId=t.value,this.getSubauthor()},changeS:function(t){console.log(void 0===t?"undefined":(0,c.default)(t)),this.contractForm.billMoney=p.default.formatNum(p.default.formatFalNum(this.contractForm.currencyMoney)*(1+t),2)},getSubauthor:function(){var t=this;this.$httpServer("/contractItem/getUserByOrgId.do",{orgId:this.orgId}).then(function(e){console.log(e),t.submitUserList=e.userList})},choosesubUser:function(t){t.label=t.label||this.submituserName,this.detailForm.submitUserId=t.value,this.detailForm.submitUserName=t.label},getVitalList:function(){var t=this;this.$httpServer("/maintenancedict/supplierVitalList.do",{}).then(function(e){t.vitalList=e.result})},uploadFile:function(t){t.target.outerHTML=t.target.outerHTML;var e=t.target.files,a=[];e&&e.length&&Array.prototype.push.apply(a,e);for(var r=0;r<a.length;r++)a[r].flag="0",this.file.push(a[r]),console.log(this.file),this.fileList.push(a[r]),console.log(this.fileList);this.fileFlag=this.fileList.map(function(t){return t.flag}),console.log(this.fileFlag)},chooseFileType:function(t){this.fileFlag=this.fileList.map(function(t){return t.flag}),console.log(this.fileFlag),console.log(this.file)},deleteFile:function(t){var e=this;if(console.log(t),void 0==t.fileId){for(var a=0;a<this.fileList.length;a++)if(t.name==this.fileList[a].name){this.fileList.splice(a,1),this.fileFlag.splice(a,1);break}}else{var r={fileId:t.fileId};this.$httpServer("/contractFile/deleteFile.do",r).then(function(t){200==t.status&&(e.$Message.success("删除成功"),e.getMainFileList())})}},selectModel:function(t){this.deleteList=t,console.log(t)},clickRow:function(t,e){console.log(t),this.modal1=!0,this.digType=!0,this.materIndex=e,this.deleteList.push(t),this.detailForm.materialName=t.materialName,this.detailForm.spectype=t.spectype,this.detailForm.figureNo=t.figureNo,this.detailForm.metricunitName=t.metricunitName,this.detailForm.price=p.default.formatNum(t.price),this.detailForm.needQuantity=t.needQuantity,this.detailForm.sumMoney=p.default.formatNum(t.sumMoney),console.log(this.detailForm.sumMoney+"-----"),console.log(t.sumMoney),this.detailForm.supplyPlace=t.supplyPlace,this.detailForm.supplyDate=t.supplyDate,this.detailForm.contractItemid=t.contractItemid},saveContract:function(t){var e=this;this.$refs.contractForm.validate(function(a){if(console.log(a),console.log(e.material),a){"S01"==t&&0==e.typeSelect?(e.baseUrl="/contractCore/setContract.do",e.contractId=""):"S02"==t&&0==e.typeSelect?(e.contractId="0",e.baseUrl="/contractCore/updateContractType.do"):"S01"==t&&1==e.typeSelect?e.baseUrl="/contractCore/updateContract.do":"S02"==t&&1==e.typeSelect&&(e.baseUrl="/contractCore/updateContractType.do"),e.contractForm.contractId=e.contractId;var r=(0,l.default)({},e.contractForm);console.log(r);var o=new FormData;if(""==e.material||0==e.material.length)return e.$Message.warning("请添加明细信息"),!1;for(var i=0;i<e.file.length;i++)o.append("files",e.file[i]);o.append("contractModel",(0,n.default)(r)),o.append("contractItemModel",(0,n.default)(e.material)),o.append("fileFlag",e.fileFlag),e.$fdServer(e.baseUrl,o).then(function(t){console.log(t),200==t.status&&(e.$Message.success("保存成功"),e.backlist())})}else e.$Message.warning("请仔细填写基础信息")})},saveMaterial:function(t){var e=this;this.$refs.detailForm.validate(function(a){if(a){if("S01"==t){if(0==e.digType){if(1==e.typeSelect)e.modal1=!1,e.saveMaterialList();else if(0==e.typeSelect){var r=new Date(e.detailForm.supplyDate),o=r.getFullYear()+"-"+p.default.repairZ(r.getMonth()+1)+"-"+p.default.repairZ(r.getDate());e.detailForm.supplyDate=o,console.log(o),e.detailForm.id=e.num++;var n=(0,l.default)({},e.detailForm);e.material.push(n),e.modal1=!1,e.$Message.success("保存成功"),e.$refs.detailForm.resetFields()}}else if(1==e.typeSelect){var r=new Date(e.detailForm.supplyDate),o=r.getFullYear()+"-"+p.default.repairZ(r.getMonth()+1)+"-"+p.default.repairZ(r.getDate());e.detailForm.supplyDate=o,e.detailForm.contractId=e.contractId,e.detailForm.price=p.default.formatFalNum(e.detailForm.price),e.detailForm.sumMoney=p.default.formatFalNum(e.detailForm.sumMoney);var i=(0,l.default)({},e.detailForm);console.log(i),e.$httpServer("/contractItem/updateContractItem.do",i).then(function(t){console.log(t),200==t.status&&(e.getMainMaterial(),e.modal1=!1,e.$Message.success("修改成功"),e.$refs.detailForm.resetFields())})}else if(0==e.typeSelect){var r=new Date(e.detailForm.supplyDate),o=r.getFullYear()+"-"+p.default.repairZ(r.getMonth()+1)+"-"+p.default.repairZ(r.getDate());console.log(o),e.detailForm.supplyDate=o;var s=(0,l.default)({},e.detailForm);console.log(s);for(var c=0;c<e.material.length;c++)e.material.splice(e.materIndex,1,s);e.modal1=!1,e.$Message.success("修改成功"),e.$refs.detailForm.resetFields()}}else if("S02"==t)if(0==e.digType)if(1==e.typeSelect)e.saveMaterialList();else{var r=new Date(e.detailForm.supplyDate),o=r.getFullYear()+"-"+p.default.repairZ(r.getMonth()+1)+"-"+p.default.repairZ(r.getDate());console.log(o),e.detailForm.supplyDate=o,e.detailForm.id=e.num++;var d=(0,l.default)({},e.detailForm);e.material.push(d),e.$refs.detailForm.resetFields(),e.$Message.success("保存成功"),conosle.log(e.material)}else e.deleteMaterial()}else console.log(e.detailForm),e.$Message.warning("请仔细填写物资明细")})},saveMaterialList:function(){var t=this;this.detailForm.contractId=this.contractId,this.detailForm.price=p.default.formatFalNum(this.detailForm.price),this.detailForm.sumMoney=p.default.formatFalNum(this.detailForm.sumMoney);var e=(0,l.default)({},this.detailForm);console.log(e),this.$httpServer("/contractItem/setContractItem.do",e).then(function(e){console.log(e),200==e.status&&(t.getMainMaterial(),t.$Message.success("保存成功"),t.$refs.detailForm.resetFields())})},deleteMaterial:function(){var t=this;if(0!=this.deleteList.length)if(0==this.typeSelect){if(this.deleteList.length==this.material.length)this.material=[];else for(var e=0;e<this.material.length;e++)for(var a=0;a<this.deleteList.length;a++)if(this.material[e].id==this.deleteList[a].id){this.modal2=!1,this.modal1=!1,this.$Message.success("删除成功"),this.material.splice(e,this.deleteList.length),null!=this.material&&0!=this.material.length&&""!=this.material||(this.modal2=!1,this.modal1=!1);break}}else{var r={id:""},o=[];console.log(this.deleteList);for(var e=0;e<this.deleteList.length;e++)r.id=this.deleteList[e].contractItemid,o.push(this.deleteList[e].contractItemid.toString());console.log(o),this.$httpServer("/contractItem/deleteContractItem.do",{contractItemid:(0,n.default)(o)}).then(function(e){console.log(e),200==e.status&&(t.$Message.success("删除成功"),t.deleteList=[],t.getMainMaterial(),t.modal2=!1,t.modal1=!1,t.$refs.detailForm.resetFields())})}else this.$Message.warning("请选择要删除的明细")}},watch:{fileList:function(t){t.length>=5?(this.$Message.warning("附件上传不得大于5个"),this.flieDisabled=!0):this.flieDisabled=!1},material:function(t){var e=t.map(function(t){return"number"==typeof t.price?t.price*t.needQuantity:p.default.formatFalNum(t.price)*t.needQuantity}),a=e.reduce(function(t,e){return t+e},0);this.contractForm.currencyMoney=p.default.formatNum(a,2),this.contractForm.billMoney=p.default.formatNum(p.default.formatFalNum(this.contractForm.currencyMoney)*parseFloat(1+this.contractForm.taxRate),2)},"detailForm.price":function(t){if(""==t)return void(this.detailForm.sumMoney=0);this.detailForm.sumMoney="number"==typeof t?p.default.formatNum(t*this.detailForm.needQuantity):p.default.formatNum(p.default.formatFalNum(t)*this.detailForm.needQuantity)},"detailForm.needQuantity":function(t){if(console.log(t),""==t||""===this.detailForm.price)return void(this.detailForm.sumMoney=0);this.detailForm.sumMoney=p.default.formatNum(t*p.default.formatFalNum(this.detailForm.price))},modal1:function(t){1==t||(this.deleteList=[])}}}},953:function(t,e,a){var r=a(954);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(20)("1ceaf100",r,!1)},954:function(t,e,a){e=t.exports=a(19)(void 0),e.push([t.i,'\n.margin-top-8 {\n  margin-top: 8px;\n}\n.margin-top-10 {\n  margin-top: 10px;\n}\n.margin-top-20 {\n  margin-top: 20px;\n}\n.margin-left-10 {\n  margin-left: 10px;\n}\n.margin-left-50 {\n  margin-left: 50px;\n}\n.margin-bottom-10 {\n  margin-bottom: 10px;\n}\n.margin-bottom-100 {\n  margin-bottom: 100px;\n}\n.margin-right-10 {\n  margin-right: 10px;\n}\n.margin-right-20 {\n  margin-right: 20px;\n}\n.padding-bottom-10 {\n  padding-bottom: 10px;\n}\n.padding-left-6 {\n  padding-left: 6px;\n}\n.padding-left-8 {\n  padding-left: 5px;\n}\n.padding-left-10 {\n  padding-left: 10px;\n}\n.padding-left-20 {\n  padding-left: 20px;\n}\n.height-100 {\n  height: 100%;\n}\n.height-120px {\n  height: 100px;\n}\n.height-200px {\n  height: 200px;\n}\n.height-492px {\n  height: 492px;\n}\n.height-460px {\n  height: 460px;\n}\n.line-gray {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5 {\n  padding-left: 10px;\n}\n[v-cloak] {\n  display: none;\n}\n.clearfix:after {\n  content: ".";\n  clear: both;\n  display: block;\n  height: 0;\n  overflow: hidden;\n  visibility: hidden;\n}\n.clearfix {\n  zoom: 1;\n}\n.fl {\n  float: left;\n}\n.fr {\n  float: right;\n}\n.file {\n  position: relative;\n  display: inline-block;\n  background: #D0EEFF;\n  border: 1px solid #99D3F5;\n  border-radius: 4px;\n  padding: 4px 12px;\n  overflow: hidden;\n  color: #1E88C7;\n  text-decoration: none;\n  text-indent: 0;\n  line-height: 20px;\n}\n.file input {\n  position: absolute;\n  font-size: 100px;\n  right: 0;\n  top: 0;\n  opacity: 0;\n}\n.file:hover {\n  background: #AADFFD;\n  border-color: #78C3F3;\n  color: #004974;\n  text-decoration: none;\n}\n.my-upload div table tr {\n  font-size: 12px;\n}\n.greyCol {\n  color: #999;\n}\n.expand-row {\n  margin-bottom: 16px;\n  margin-top: 16px;\n  font-size: 12px;\n}\ntextarea.ivu-input {\n  font-size: 12px;\n}\n.soltTitlel {\n  line-height: 2;\n  padding: 0 16px;\n  margin-left: -16px;\n  margin-right: -19px;\n  font-weight: 900;\n  color: #464c5b;\n}\n.soltTitle {\n  line-height: 1;\n  border-bottom: 1px solid #e3e8ee;\n  padding: 17px 16px;\n  margin-left: -16px;\n  margin-right: -19px;\n  font-weight: 900;\n  color: #464c5b;\n}\n.soltTitlel {\n  line-height: 2;\n  padding: 0 16px;\n  margin-left: -16px;\n  margin-right: -19px;\n  font-weight: 900;\n  color: #464c5b;\n}\ntextarea.ivu-input {\n  font-size: 12px;\n}\n',""])},955:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{background:"#eee"}},[a("Card",{staticClass:"margin-bottom-10"},[a("Row",{attrs:{align:"middle",type:"flex"}},[a("Col",{attrs:{span:"8"}},[a("p",{staticClass:"soltTitlel"},[t._v(t._s(t.typeSelect?"编辑合同订单":"新增合同订单"))])]),t._v(" "),a("Col",{attrs:{span:"5",offset:"11"}},[a("Button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(e){t.saveContract("S01")}}},[t._v("保存")]),t._v(" "),a("Button",{staticClass:"btn",attrs:{type:"ghost"},on:{click:function(e){t.saveContract("S02")}}},[t._v("保存并提交")]),t._v(" "),a("Button",{staticClass:"btn",attrs:{type:"ghost"},on:{click:function(e){t.backlist()}}},[t._v("取消")])],1)],1)],1),t._v(" "),a("Card",{staticClass:"margin-bottom-10",attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"flag"}}),t._v(" 基本信息")],1),t._v(" "),a("Form",{ref:"contractForm",attrs:{model:t.contractForm,rules:t.ruleValidate,"label-position":"top"}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"订单编号",prop:"contractCode"}},[a("Input",{attrs:{disabled:"",placeholder:"订单编号自动生成"},model:{value:t.contractForm.contractCode,callback:function(e){t.$set(t.contractForm,"contractCode",e)},expression:"contractForm.contractCode"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"订单名称",prop:"contractName"}},[a("Input",{model:{value:t.contractForm.contractName,callback:function(e){t.$set(t.contractForm,"contractName",e)},expression:"contractForm.contractName"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"采购商名称",prop:"purchaserName"}},[a("Select",{model:{value:t.contractForm.purchaserName,callback:function(e){t.$set(t.contractForm,"purchaserName",e)},expression:"contractForm.purchaserName"}},t._l(t.purchaserList,function(e){return a("Option",{key:e.purchaseName,attrs:{value:e.purchaseName}},[t._v(t._s(e.purchaseName))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"收货人",prop:"director"}},[a("Select",{model:{value:t.contractForm.director,callback:function(e){t.$set(t.contractForm,"director",e)},expression:"contractForm.director"}},t._l(t.consigneeList,function(e){return a("Option",{key:e.receiver,attrs:{value:e.receiver}},[t._v(t._s(e.receiver))])}))],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"收货地址",prop:"deliveryAddress"}},[a("Select",{model:{value:t.contractForm.deliveryAddress,callback:function(e){t.$set(t.contractForm,"deliveryAddress",e)},expression:"contractForm.deliveryAddress"}},t._l(t.addressList,function(e){return a("Option",{key:e.id,attrs:{value:e.deliveryAddress}},[t._v(t._s(e.deliveryAddress))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"样件归属地",prop:"sampleAttribution"}},[a("Select",{model:{value:t.contractForm.sampleAttribution,callback:function(e){t.$set(t.contractForm,"sampleAttribution",e)},expression:"contractForm.sampleAttribution"}},t._l(t.sampleList,function(e){return a("Option",{key:e.sampleAttribution,attrs:{value:e.sampleAttribution}},[t._v(t._s(e.sampleAttribution))])}))],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"供应商名称",prop:"supplierId"}},[a("Select",{attrs:{"label-in-value":!0},on:{"on-change":t.chooseSuper},model:{value:t.contractForm.supplierId,callback:function(e){t.$set(t.contractForm,"supplierId",e)},expression:"contractForm.supplierId"}},t._l(t.vitalList,function(e){return a("Option",{key:e.supplierId,attrs:{value:e.supplierId}},[t._v(t._s(e.supplierName))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"卖方联系人",prop:"salesContactMan"}},[a("Select",{attrs:{"label-in-value":!0},on:{"on-change":t.choosePerson},model:{value:t.contractForm.salesContactMan,callback:function(e){t.$set(t.contractForm,"salesContactMan",e)},expression:"contractForm.salesContactMan"}},t._l(t.SellerList,function(e){return a("Option",{key:e.id,attrs:{value:e.loginName}},[t._v(t._s(e.loginName))])}))],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"订单金额(未税)",prop:"currencyMoney"}},[a("Input",{attrs:{disabled:!0,placeholder:"此金额由明细自动计算"},model:{value:t.contractForm.currencyMoney,callback:function(e){t.$set(t.contractForm,"currencyMoney",e)},expression:"contractForm.currencyMoney"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"税率",prop:"taxRate"}},[a("Select",{on:{"on-change":t.changeS},model:{value:t.contractForm.taxRate,callback:function(e){t.$set(t.contractForm,"taxRate",e)},expression:"contractForm.taxRate"}},[a("Option",{attrs:{value:""}},[t._v("请选择税率")]),t._v(" "),t._l(t.taxRateList,function(e){return a("Option",{key:e.taxRate,attrs:{value:e.taxRate}},[t._v(t._s(t._f("numberF")(100*e.taxRate))+"%")])})],2)],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"订单总金额",prop:"billMoney"}},[a("Input",{attrs:{disabled:"",placeholder:"此金额自动算出"},model:{value:t.contractForm.billMoney,callback:function(e){t.$set(t.contractForm,"billMoney",e)},expression:"contractForm.billMoney"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"外协件要样订单申请单号",prop:"sampleDemoBillNo"}},[a("Input",{model:{value:t.contractForm.sampleDemoBillNo,callback:function(e){t.$set(t.contractForm,"sampleDemoBillNo",e)},expression:"contractForm.sampleDemoBillNo"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11",offset:"0"}},[a("FormItem",{attrs:{label:"工程师"}},[a("AutoComplete",{on:{"on-search":t.getEngineer},model:{value:t.contractForm.engineers,callback:function(e){t.$set(t.contractForm,"engineers",e)},expression:"contractForm.engineers"}},t._l(t.engineersList,function(e,r){return a("Option",{key:r,attrs:{value:e.loginName}},[t._v(t._s(e.loginName))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"项目经理"}},[a("AutoComplete",{on:{"on-search":t.getProjectManager},model:{value:t.contractForm.projectManager,callback:function(e){t.$set(t.contractForm,"projectManager",e)},expression:"contractForm.projectManager"}},t._l(t.projectManagerList,function(e,r){return a("Option",{key:r,attrs:{value:e.loginName}},[t._v(t._s(e.loginName))])}))],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"结算方式"}},[a("Select",{model:{value:t.contractForm.settingMethod,callback:function(e){t.$set(t.contractForm,"settingMethod",e)},expression:"contractForm.settingMethod"}},t._l(t.settlementList,function(e){return a("Option",{key:e.settingMethod,attrs:{value:e.settingMethod}},[t._v(t._s(e.settingMethod))])}))],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"订单性质"}},[a("Select",{model:{value:t.contractForm.orderNature,callback:function(e){t.$set(t.contractForm,"orderNature",e)},expression:"contractForm.orderNature"}},t._l(t.orderNatuteList,function(e){return a("Option",{key:e.orderNature,attrs:{value:e.orderNature}},[t._v(t._s(e.orderNature))])}))],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11",offset:"0"}},[a("FormItem",{attrs:{label:"备注",prop:"remarks"}},[a("Input",{staticStyle:{"font-size":"12px"},attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:t.contractForm.remarks,callback:function(e){t.$set(t.contractForm,"remarks",e)},expression:"contractForm.remarks"}})],1)],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"soltTitle margin-bottom-10"},[a("Icon",{attrs:{type:"ios-cloud-upload"}}),t._v(" 附件")],1)]),t._v(" "),a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"my-upload"},[a("a",{staticClass:"file",attrs:{href:"javascript:;",disabled:t.flieDisabled},on:{change:function(e){t.uploadFile(e)}}},[t._v("选择文件\n                    "),a("input",{attrs:{type:"file",name:"",id:""}})]),t._v(" "),a("div",[a("table",t._l(t.fileList,function(e,r){return a("tr",{staticStyle:{"font-size":"12px"}},[a("td",{staticStyle:{padding:"0 10px"}},[t._v(t._s(r+1))]),t._v(" "),a("td",{staticStyle:{padding:"0 10px"}},[t._v(t._s(e.name))]),t._v(" "),a("td",{staticStyle:{padding:"0 10px"}},[a("Select",{attrs:{size:"small","label-in-value":!0},on:{"on-change":t.chooseFileType},model:{value:e.flag,callback:function(a){t.$set(e,"flag",a)},expression:"item.flag"}},[a("Option",{key:0,attrs:{value:"0"}},[t._v("内部文件")]),t._v(" "),a("Option",{key:1,attrs:{value:"1"}},[t._v("外部文件")])],1)],1),t._v(" "),a("td",{staticStyle:{padding:"0 10px"}},[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){t.deleteFile(e)}}},[t._v("删除")])])])}))])])])],1)],1),t._v(" "),a("Card",{attrs:{bordered:!1}},[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"navicon"}}),t._v(" 明细信息\n            "),a("a",{staticClass:"fr",attrs:{href:"javascript:;"},on:{click:t.showDig}},[a("Icon",{attrs:{type:"plus"}}),t._v("  添加")],1),t._v(" "),a("a",{staticClass:"fr margin-right-20",attrs:{href:"javascript:;"},on:{click:t.deleteMaterial}},[a("Icon",{attrs:{type:"trash-a"}}),t._v("  删除")],1)],1),t._v(" "),a("Table",{attrs:{height:"200",columns:t.columns2,data:t.material,size:"small",border:!1},on:{"on-selection-change":t.selectModel,"on-row-click":t.clickRow}})],1),t._v(" "),a("Modal",{attrs:{title:t.digType?"编辑明细":"新增明细",width:"50%"},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[a("Form",{ref:"detailForm",attrs:{model:t.detailForm,rules:t.ruleValidate2,"label-position":"top"}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"物资名称",prop:"materialName"}},[a("Input",{model:{value:t.detailForm.materialName,callback:function(e){t.$set(t.detailForm,"materialName",e)},expression:"detailForm.materialName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"材料规格型号",prop:"spectype"}},[a("Input",{model:{value:t.detailForm.spectype,callback:function(e){t.$set(t.detailForm,"spectype",e)},expression:"detailForm.spectype"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"计量单位",prop:"metricunitName"}},[a("Input",{model:{value:t.detailForm.metricunitName,callback:function(e){t.$set(t.detailForm,"metricunitName",e)},expression:"detailForm.metricunitName"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"单价(未税)",prop:"price"}},[a("Input",{model:{value:t.detailForm.price,callback:function(e){t.$set(t.detailForm,"price",e)},expression:"detailForm.price"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"需求数量",prop:"needQuantity"}},[a("Input",{model:{value:t.detailForm.needQuantity,callback:function(e){t.$set(t.detailForm,"needQuantity",e)},expression:"detailForm.needQuantity"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"总价(未税)",prop:"sumMoney"}},[a("Input",{attrs:{disabled:""},model:{value:t.detailForm.sumMoney,callback:function(e){t.$set(t.detailForm,"sumMoney",e)},expression:"detailForm.sumMoney"}})],1)],1)],1),t._v(" "),a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{label:"到货日期",prop:"supplyDate"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"到货日期"},model:{value:t.detailForm.supplyDate,callback:function(e){t.$set(t.detailForm,"supplyDate",e)},expression:"detailForm.supplyDate"}})],1)],1),t._v(" "),a("Col",{attrs:{span:"11",offset:"2"}},[a("FormItem",{attrs:{label:"图号",prop:"figureNo"}},[a("Input",{model:{value:t.detailForm.figureNo,callback:function(e){t.$set(t.detailForm,"figureNo",e)},expression:"detailForm.figureNo"}})],1)],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",loading:t.modal_loading},on:{click:function(e){t.saveMaterial("S01")}}},[t._v(t._s((t.digType,"保存")))]),t._v(" "),a("Button",{attrs:{type:"primary",loading:t.modal_loading},on:{click:function(e){t.saveMaterial("S02")}}},[t._v(t._s(t.digType?"删除":"保存并添加"))]),t._v(" "),a("Button",{attrs:{type:"ghost",loading:t.modal_loading},on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)},o=[];r._withStripped=!0;var n={render:r,staticRenderFns:o};e.default=n}});