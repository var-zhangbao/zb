webpackJsonp([38],{1117:function(t,e,n){var a=n(1118);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n(18)("69d38b50",a,!1)},1118:function(t,e,n){e=t.exports=n(17)(void 0),e.push([t.i,'\n.margin-top-8 {\n  margin-top: 8px;\n}\n.margin-top-10 {\n  margin-top: 10px;\n}\n.margin-top-20 {\n  margin-top: 20px;\n}\n.margin-left-10 {\n  margin-left: 10px;\n}\n.margin-left-50 {\n  margin-left: 50px;\n}\n.margin-bottom-10 {\n  margin-bottom: 10px;\n}\n.margin-bottom-100 {\n  margin-bottom: 100px;\n}\n.margin-right-10 {\n  margin-right: 10px;\n}\n.margin-right-20 {\n  margin-right: 20px;\n}\n.padding-bottom-10 {\n  padding-bottom: 10px;\n}\n.padding-left-6 {\n  padding-left: 6px;\n}\n.padding-left-8 {\n  padding-left: 5px;\n}\n.padding-left-10 {\n  padding-left: 10px;\n}\n.padding-left-20 {\n  padding-left: 20px;\n}\n.height-100 {\n  height: 100%;\n}\n.height-120px {\n  height: 100px;\n}\n.height-200px {\n  height: 200px;\n}\n.height-492px {\n  height: 492px;\n}\n.height-460px {\n  height: 460px;\n}\n.line-gray {\n  height: 0;\n  border-bottom: 2px solid #dcdcdc;\n}\n.notwrap {\n  word-break: keep-all;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.padding-left-5 {\n  padding-left: 10px;\n}\n[v-cloak] {\n  display: none;\n}\n.clearfix:after {\n  content: ".";\n  clear: both;\n  display: block;\n  height: 0;\n  overflow: hidden;\n  visibility: hidden;\n}\n.clearfix {\n  zoom: 1;\n}\n.fl {\n  float: left;\n}\n.fr {\n  float: right;\n}\n.file {\n  position: relative;\n  display: inline-block;\n  background: #D0EEFF;\n  border: 1px solid #99D3F5;\n  border-radius: 4px;\n  padding: 4px 12px;\n  overflow: hidden;\n  color: #1E88C7;\n  text-decoration: none;\n  text-indent: 0;\n  line-height: 20px;\n}\n.file input {\n  position: absolute;\n  font-size: 100px;\n  right: 0;\n  top: 0;\n  opacity: 0;\n}\n.file:hover {\n  background: #AADFFD;\n  border-color: #78C3F3;\n  color: #004974;\n  text-decoration: none;\n}\n.my-upload div table tr {\n  font-size: 12px;\n}\n.greyCol {\n  color: #999;\n}\n.expand-row {\n  margin-bottom: 16px;\n  margin-top: 16px;\n  font-size: 12px;\n}\ntextarea.ivu-input {\n  font-size: 12px;\n}\n.soltTitlel {\n  line-height: 2;\n  padding: 0 16px;\n  margin-left: -16px;\n  margin-right: -19px;\n  font-weight: 900;\n  color: #464c5b;\n}\n.fr-left {\n  margin-right: 10px;\n}\n',""])},1119:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Row",[n("Col",{attrs:{span:"24"}},[n("Card",[n("Row",[n("Col",{attrs:{span:"20"}},[n("AutoComplete",{staticStyle:{width:"300px",float:"left"},attrs:{icon:"ios-search",placeholder:"订单编号/订单名称/相对方名称"},on:{"on-search":t.searchContract},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),n("Col",{attrs:{span:"4"}},[n("Button",{directives:[{name:"show",rawName:"v-show",value:t.showBtn,expression:"showBtn"}],staticClass:"fr",attrs:{type:"primary"},on:{click:function(e){t.primary()}}},[n("Icon",{attrs:{type:"plus",color:"#fff"}}),t._v("  新建")],1),t._v(" "),n("Button",{directives:[{name:"show",rawName:"v-show",value:t.showBtn,expression:"showBtn"}],staticClass:"fr fr-left",attrs:{type:"primary"},on:{click:function(e){t.showUpload()}}},[n("Icon",{attrs:{type:"ios-cloud-upload",color:"#fff"}}),t._v("  导入")],1)],1)],1),t._v(" "),n("div",{staticClass:"clearfix margin-top-10"},[n("Table",{staticStyle:{width:"100%",float:"left"},attrs:{size:"small",stripe:"",columns:t.contractColumns,data:t.contractData,loading:t.loadingMorn}}),t._v(" "),n("Page",{staticClass:"margin-top-10 fr",attrs:{total:t.totalPage,size:"small","show-elevator":"","show-sizer":""},on:{"on-change":t.changeSize,"on-page-size-change":t.changePagesize}})],1)],1)],1)],1),t._v(" "),n("Modal",{staticStyle:{"text-align":"center"},attrs:{"mask-closable":!1,title:t.typeSelect?"审批意见":"驳回意见"},on:{"on-cancel":t.cancel},model:{value:t.rejectModel,callback:function(e){t.rejectModel=e},expression:"rejectModel"}},[n("Form",{attrs:{"label-position":"top"}},[n("Row",[n("Col",{attrs:{span:"24"}},[n("FormItem",[n("Input",{attrs:{type:"textarea",maxlength:255,placeholder:"备注255个字以内"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)],1)],1)],1),t._v(" "),n("div",{staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary",loading:t.modal_loading}},[t._v("确定")]),t._v(" "),n("Button",{attrs:{type:"ghost",loading:t.modal_loading},on:{click:function(e){t.rejectModel=!1}}},[t._v("取消")])],1)],1),t._v(" "),n("Modal",{attrs:{title:"导入",width:"50%"},model:{value:t.showImport,callback:function(e){t.showImport=e},expression:"showImport"}},[n("Tabs",{attrs:{value:"name1"}},[n("TabPane",{attrs:{label:"导入主单",name:"name1"}},[n("Row",[n("Col",{staticClass:"expand-row",attrs:{span:"24"}},[n("p",[t._v("1."),n("a",{attrs:{href:"/ync/contractFile/downloadImportFile.do?fileName=htdrmb.xlsx"}},[t._v("点击下载")]),t._v("《主单导入模板》")])]),t._v(" "),n("Col",{attrs:{span:"24"}},[n("p",[t._v("2.导入主单")]),t._v(" "),n("div",{staticClass:"my-upload"},[n("a",{staticClass:"file",attrs:{href:"javascript:;"},on:{change:function(e){t.uploadMainFile(e)}}},[t._v("导入主单\n                                "),n("input",{attrs:{type:"file",name:"",id:""}})]),t._v(" "),n("div",[n("table",t._l(t.fileList,function(e,a){return n("tr",{staticStyle:{"font-size":"12px"}},[n("td",{staticStyle:{padding:"0 10px"}},[t._v(t._s(a+1))]),t._v(" "),n("td",{staticStyle:{padding:"0 10px"}},[t._v(t._s(e.name))]),t._v(" "),n("td",{staticStyle:{padding:"0 10px"}},[n("a",{staticStyle:{float:"left",width:"50px"},attrs:{href:"javascript:;"},on:{click:function(e){t.saveFile()}}},[t._v("确定")]),n("a",{attrs:{href:"javascript:;"},on:{click:function(n){t.deleteFile(e)}}},[t._v("删除")])])])}))])])])],1)],1),t._v(" "),n("TabPane",{attrs:{label:"导入明细",name:"name2"}},[n("Row",[n("Col",{staticClass:"expand-row",attrs:{span:"24"}},[n("p",[t._v("1."),n("a",{attrs:{href:"/ync/contractFile/downloadImportFile.do?fileName=htmxdrmb.xlsx"}},[t._v("点击下载")]),t._v("《明细导入模板》")])]),t._v(" "),n("Col",{attrs:{span:"24"}},[n("div",{staticClass:"my-upload"},[n("p",[t._v("2.导入明细")]),t._v(" "),n("a",{staticClass:"file",attrs:{href:"javascript:;"},on:{change:function(e){t.uploadwzFile(e)}}},[t._v("选择文件\n                                "),n("input",{attrs:{type:"file",name:"",id:""}})]),t._v(" "),n("div",[n("table",t._l(t.filewzList,function(e,a){return n("tr",{staticStyle:{"font-size":"12px"}},[n("td",{staticStyle:{padding:"0 10px"}},[t._v(t._s(a+1))]),t._v(" "),n("td",{staticStyle:{padding:"0 10px"}},[t._v(t._s(e.name))]),t._v(" "),n("td",{staticStyle:{padding:"0 10px"}},[n("a",{staticStyle:{float:"left",width:"50px"},attrs:{href:"javascript:;"},on:{click:function(e){t.savewzFile()}}},[t._v("确定")]),n("a",{attrs:{href:"javascript:;"},on:{click:function(n){t.deletewzFile(e)}}},[t._v("删除")])])])}))])])])],1)],1)],1)],1)],1)},o=[];a._withStripped=!0;var i={render:a,staticRenderFns:o};e.default=i},295:function(t,e,n){"use strict";function a(t){l||n(1117)}Object.defineProperty(e,"__esModule",{value:!0});var o=n(583),i=n.n(o);for(var r in o)"default"!==r&&function(t){n.d(e,t,function(){return o[t]})}(r);var s=n(1119),c=n.n(s),l=!1,p=n(1),d=a,f=p(i.a,c.a,!1,d,null,null);f.options.__file="src/views/contract/contractMain.vue",e.default=f.exports},583:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=a(o),r=n(10);a(r);e.default={name:"contractOrder",data:function(){var t=this;return{totalPage:1,pageIndex:1,pageSize:10,loadingMorn:!1,rejectModel:!1,modal_loading:!1,typeSelect:!1,showImport:!1,description:"",searchValue:"",fileList:[],filewzList:[],contractColumns:[{type:"index",title:"序号",width:60},{title:"订单编号",key:"contractCode",sortable:!0,render:function(e,n){return e("span",[e("a",{style:{},on:{click:function(){t.lookDetail(n.row.contractId)}}},n.row.contractCode)])}},{title:"订单名称",key:"contractName",sortable:!0},{title:"相对方",key:"relativeName"},{title:"状态",key:"state",width:80,render:function(t,e){switch(e.row.state){case 1:return t("span","待提交");case 2:return t("span","待确认");case 4:return t("span","已生效");case 5:return t("span","已驳回");case 7:return t("span","履行中")}}},{title:"操作",key:"operation",render:function(e,n){if("1"===t.userType)switch(n.row.state){case 1:return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.submitContract(n.row.contractId)}}},"提交"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.editContact(n.row.contractId)}}},"维护"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.deleteContract(n.row.contractId)}}},"删除")]);case 2:case 4:return e("div",[]);case 5:return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.submitContract(n.row.contractId)}}},"提交"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.editContact(n.row.contractId)}}},"维护"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.deleteContract(n.row.contractId)}}},"删除")]);case 7:return e("div",[])}else if("0"===t.userType)switch(n.row.state){case 1:return e("div",[]);case 2:return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.sureContract(n.row.contractId,4)}}},"确认"),e("Button",{props:{type:"text",size:"small"},style:{color:"#2d8cf0"},on:{click:function(){t.sureContract(n.row.contractId,5)}}},"驳回")]);case 4:case 5:case 7:return e("div",[])}}}],contractData:[],userType:"",showBtn:!1,contractCode:"",contractName:"",supplierName:"",para:{},file:[],wzfile:[]}},mounted:function(){console.log(this.$router);var t=JSON.parse(i.default.get("userData"));this.userType=t.userType,"0"===this.userType?this.showBtn=!1:this.showBtn=!0,this.getContractList()},methods:{primary:function(){var t={contract_State:1001};this.$router.push({name:"addContract_index",query:t})},showUpload:function(){this.showImport=!0},editContact:function(t){var e={contract_State:1002,contract_Id:t};this.$router.push({name:"addContract_index",query:e})},lookDetail:function(t){var e={contract_Id:t};this.$router.push({name:"contractDetail_index",query:e})},changeSize:function(t){this.pageIndex=t,this.getContractList()},changePagesize:function(t){this.pageSize=t,this.getContractList()},getContractList:function(t){var e=this;t?(this.para={pageIndex:this.pageIndex,pageSize:this.pageSize,inputParam:this.searchValue},this.para[t.key]=t.order):this.para={pageIndex:this.pageIndex,pageSize:this.pageSize,inputParam:this.searchValue},this.loadingMorn=!0,this.$httpServer("/contractCore/getContractList.do",this.para).then(function(t){if(console.log(t),null==t.result)return e.loadingMorn=!1,e.contractData=[],!1;e.contractData=t.result.list,e.totalPage=t.result.totalCount,e.loadingMorn=!1})},searchContract:function(t){this.searchValue=t,this.getContractList()},submitContract:function(t){var e=this,n={contractId:t};this.$httpServer("/contractCore/submitContract.do",n).then(function(t){console.log(t),200==t.status&&(e.getContractList(),e.$Message.success("订单已提交"))})},cancelContract:function(t){var e=this,n={contractId:t};this.$httpServer("/contractCore/cancelContract.do",n).then(function(t){200==t.status&&(e.getContractList(),e.$Message.success("订单已撤回"))})},sureContract:function(t,e){var n=this,a={contractId:t,state:e};this.$httpServer("/contractCore/confirmContractByState.do",a).then(function(t){if(200==t.status)switch(e){case 4:n.$Message.success("订单已确认"),n.getContractList();break;case 5:n.$Message.success("订单已驳回"),n.getContractList()}})},deleteContract:function(t){var e=this,n={contractId:t};this.$httpServer("/contractCore/deleteContract.do",n).then(function(t){200==t.status&&(e.getContractList(),e.$Message.success("订单已删除"))})},rejectContract:function(t){this.rejectModel=!0},approvalContract:function(t){this.rejectModel=!0,this.typeSelect=!0},cancel:function(){this.rejectModel=!1},uploadMainFile:function(t){t.target.outerHTML=t.target.outerHTML;var e=t.target.files,n=[];e&&e.length&&Array.prototype.push.apply(n,e);for(var a=0;a<n.length;a++)n[0].flag="0",this.file.push(n[0]),console.log(this.file),this.fileList.push(n[0]),console.log(this.fileList)},deleteFile:function(t){if(console.log(t),void 0==t.fileId)for(var e=0;e<this.fileList.length;e++)if(t.name==this.fileList[e].name){this.fileList.splice(e,1);break}},saveFile:function(){for(var t=this,e=new FormData,n=0;n<this.file.length;n++)e.append("fileField",this.file[0]);this.$fdServer("/contractImport/contractImport.do",e).then(function(e){console.log(e),200==e.status?(t.$Message.success("订单已导入,请导入明细"),t.fileList=[],t.file=[],t.getContractList()):t.$Message.error("订单导入失败")})},uploadwzFile:function(t){t.target.outerHTML=t.target.outerHTML;var e=t.target.files,n=[];e&&e.length&&Array.prototype.push.apply(n,e);for(var a=0;a<n.length;a++)n[0].flag="0",this.wzfile.push(n[0]),console.log(this.wzfile),this.filewzList.push(n[0]),console.log(this.filewzList)},deletewzFile:function(t){if(console.log(t),void 0==t.fileId)for(var e=0;e<this.filewzList.length;e++)if(t.name==this.filewzList[e].name){this.filewzList.splice(e,1);break}},savewzFile:function(){for(var t=this,e=new FormData,n=0;n<this.wzfile.length;n++)e.append("fileField",this.wzfile[0]);this.$fdServer("/contractImport/contractItemImport.do",e).then(function(e){console.log(e),200==e.status?(t.$Message.success("订单明细已导入"),t.filewzList=[],t.wzfile=[],t.getContractList(),t.showImport=!1):t.$Message.error("订单明细导入失败")})}}}}});